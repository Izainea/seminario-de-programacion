
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Uso de Pandas &#8212; Introducción a Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Cuadernos/Minutos y segundos';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Trabajemos en algunos gráficos" href="Graficos.html" />
    <link rel="prev" title="Introducción a Python y Pandas" href="Intro%20a%20Python%20y%20Pandas.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="introduccion.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Introducción a Machine Learning - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Introducción a Machine Learning - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="introduccion.html">
                    Introducción al Machine Learning
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Intro%20a%20Python%20y%20Pandas.html">Introducción a Python y Pandas</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Uso de Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Graficos.html">Trabajemos en algunos gráficos</a></li>
<li class="toctree-l1"><a class="reference internal" href="Medidas%20Estadisticas.html">Medidas estadísticas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visualizaci%C3%B3n%20en%20Python.html">Visualización de datos con Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Manipulaci%C3%B3n%2C%20Limpieza%20y%20Exploraci%C3%B3n%20de%20Datos.html">Manipulación, Limpieza y Exploración de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="Aprendizaje%20Autom%C3%A1tico.html">Introducción al Aprendizaje Automático</a></li>
<li class="toctree-l1"><a class="reference internal" href="Arboles%20de%20decisi%C3%B3n.html">Árboles de Decisión para Marketing Bancario</a></li>
<li class="toctree-l1"><a class="reference internal" href="Estadisticos%20de%20Validaci%C3%B3n.html">Estadísticos de Validación de un Modelo de Clasificación Supervisada</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modelos%20de%20Clasificaci%C3%B3n%20I.html">Primer resumen sobre modelos de clasificación supervisada</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modelos%20de%20Clasificaci%C3%B3n%20II.html">Segundo resumen sobre modelos de clasificación supervisada</a></li>
<li class="toctree-l1"><a class="reference internal" href="Ejercicio%20K%20Means.html">Algoritmos Clúster</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Izainea/seminario-de-programacion" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Izainea/seminario-de-programacion/issues/new?title=Issue%20on%20page%20%2FCuadernos/Minutos y segundos.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Cuadernos/Minutos y segundos.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Uso de Pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion">Introducción</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#que-se-quiere-identificar">¿Qué se quiere identificar?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#insumos-para-tratar-este-problema">Insumos para tratar este problema</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#objetivos">Objetivos</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#importacion-de-paquetes">Importación de paquetes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion-a-pandas">Introducción a pandas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-informacion-en-pandas">Carga de información en <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manejo-de-datos-duplicados">Manejo de datos duplicados</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manejo-de-datos-perdidos-o-esperados">Manejo de datos perdidos o esperados</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculo-de-estadisticas-resumen">Cálculo de estadísticas resumen</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agregar-informacion-de-multiples-tablas">Agregar información de múltiples tablas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-1">Ejercicio 1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cruce-de-informacion">Cruce de información</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uniones-joins">Uniones (Joins)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-2">Ejercicio 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agrupacion-por-area-geografica">Agrupación por área geográfica</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-3">Ejercicio 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#etiquetando-valores-de-total-de-ingresos-en-categorias">Etiquetando valores de total de ingresos en categorías</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#existe-relacion-alguna-entre-el-total-de-minutos-usados-con-la-compania-y-el-ingreso-total-de-los-clientes">¿Existe relación alguna entre el total de minutos usados con la compañía y el ingreso total de los clientes?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-4">Ejercicio 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-total-de-llamadas-y-total-de-ingresos">Visualización de total de llamadas y total de ingresos</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#histograma">Histograma</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">Boxplot</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-a-partir-de-groupby">Gráficas a partir de <code class="docutils literal notranslate"><span class="pre">groupby</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-de-pandas">Gráficas de <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seaborn"><code class="docutils literal notranslate"><span class="pre">Seaborn</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-de-parcela">Gráficas de parcela</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-5">Ejercicio 5</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen">Resumen</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="uso-de-pandas">
<h1>Uso de Pandas<a class="headerlink" href="#uso-de-pandas" title="Link to this heading">#</a></h1>
<p>En el desarrollo de este caso introduciremos las librerías pandas, numpy y matplotlib para el preprocesamiento, visualización de un conjunto de datos y el desarrollo de algunas medidas estadísticas descriptivas.</p>
<div class="admonition-pandas admonition">
<p class="admonition-title">Pandas</p>
<p>Pandas es la librería aliada para el análisis de datos, con ella puede cargar fácilmente datos en formato CSV, Excel, SQL, entre otros. Además, permite realizar operaciones de filtrado, limpieza, transformación y análisis de datos.</p>
</div>
<section id="introduccion">
<h2>Introducción<a class="headerlink" href="#introduccion" title="Link to this heading">#</a></h2>
<p>La revisión del comportamiento de los clientes en cualquier empresa es de vital importancia para el desarrollo de estrategias  tanto de mejoramiento de productos como de publicidad y toma de decisiones. Evaluaremos la información obtenida de un conjunto de registro obtenidos de una empresa de telecomunicaciones que cuenta con la revisión de las siguientes variables:</p>
<ol class="arabic simple">
<li><p>totrev: Ingresos del cliente</p></li>
<li><p>totmou: Total de minutos usados por el cliente</p></li>
<li><p>area: Área geográfica</p></li>
<li><p>creditcd: Indicador de tarjeta de crédito</p></li>
<li><p>eqpdays: Número de días (antigüedad) del equipo actual</p></li>
</ol>
<p>Es importante mencionar que la empresa contiene una gran cantidad de clientes y hacer el análisis uno a uno no es lo  óptimo. Con ayuda de la programación y el análisis de datos, se logrará llegar a conclusiones rápidas y acertadas para encontrar relaciones que a simple vista no son tenidas en cuenta.</p>
<section id="que-se-quiere-identificar">
<h3>¿Qué se quiere identificar?<a class="headerlink" href="#que-se-quiere-identificar" title="Link to this heading">#</a></h3>
<p>Teniendo en cuenta la información de la base de datos se quiere identificar si hay una relación entre el total de minutos usados por el cliente con la compañía y el ingreso total de los clientes, es decir, Será posible afirmar que cuando una persona
tiene un mayor ingreso mayor entonces es mayor la utilización de minutos o todo lo contrario?</p>
<section id="insumos-para-tratar-este-problema">
<h4>Insumos para tratar este problema<a class="headerlink" href="#insumos-para-tratar-este-problema" title="Link to this heading">#</a></h4>
<p>Teniendo en cuenta que la compañía tenia estándares para la entrega de la información, se dispone de un  conjunto de tablas en formato CSV ordenado de la siguiente manera:
La información de este conjunto de datos puede encontrase en <a class="reference external" href="https://www.kaggle.com/abhinav89/telecom-customer?select=Telecom_customer+churn.csv">aquí</a></p>
</section>
</section>
<section id="objetivos">
<h3>Objetivos<a class="headerlink" href="#objetivos" title="Link to this heading">#</a></h3>
<p>En este caso usted tendrá que cargar varias bases de datos, hará una exploración básica sobre la información y fusionará las distintas bases para tener una visión general del problema. La idea es que desarrolle las siguientes habilidades:</p>
<ol class="arabic simple">
<li><p>Manejo de la librería pandas de Python para cargar y leer datos;</p></li>
<li><p>Ideas elementales para una útil transformación de los datos;</p></li>
<li><p>Construcción y presentación de argumentos válidos que le brindarán una solución para la pregunta expresada más arriba y llegar a una conclusión.</p></li>
<li><p>Visualización de gráficas elementales que le permitirá entender mejor la información contenida en los datos.</p></li>
</ol>
<section id="importacion-de-paquetes">
<h4>Importación de paquetes<a class="headerlink" href="#importacion-de-paquetes" title="Link to this heading">#</a></h4>
<p>Una de las mejores opciones para trabajar con datos tabulares en Python es usar el módulo pandas. La librería <code class="docutils literal notranslate"><span class="pre">pandas</span></code> provee estructuras de datos, genera gráficos de alta calidad con <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> y se integra de buena forma con otras librerías que usan arrays de <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<p>Debemos revisar si la librería se encuentra en nuestro sistema usando el comando</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">show</span> <span class="n">librería</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>show<span class="w"> </span>pandas
<span class="c1">#!pip show numpy</span>
<span class="c1">#!pip show matplotlib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name: pandas
Version: 2.1.3
Summary: Powerful data structures for data analysis, time series, and statistics
Home-page: https://pandas.pydata.org
Author: 
Author-email: The Pandas Development Team &lt;pandas-dev@python.org&gt;
License: BSD 3-Clause License

Copyright (c) 2008-2011, AQR Capital Management, LLC, Lambda Foundry, Inc. and PyData Development Team
All rights reserved.

Copyright (c) 2011-2023, Open source contributors.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

* Neither the name of the copyright holder nor the names of its
  contributors may be used to endorse or promote products derived from
  this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
Location: C:\Users\cizai\miniconda3\Lib\site-packages
Requires: numpy, python-dateutil, pytz, tzdata
Required-by: altair, prince, seaborn, streamlit
</pre></div>
</div>
</div>
</div>
<p>En el caso de que la librería no se encuentre instalada ejecutamos el comando</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">librería</span>
</pre></div>
</div>
<p>Para importar las librerías usamos el comando</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">librería</span> <span class="k">as</span> <span class="nn">alias</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1">### Eliminación de warnings</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Luego de que tener los paquetes activados dentro de nuestro ambiente de python podremos usar las fucnciones que se encuentren en la librería.</p>
</section>
</section>
<section id="introduccion-a-pandas">
<h3>Introducción a pandas<a class="headerlink" href="#introduccion-a-pandas" title="Link to this heading">#</a></h3>
<p>Poner información sobre pandas e indicar la diferencia entre series y dataframe</p>
<p><img alt="" src="https://www.cdn.geeksforgeeks.org/wp-content/uploads/creating_dataframe1.png" /></p>
<p>A continuación, mostramos el código a ejecutar para crear una <code class="docutils literal notranslate"> <span class="pre">Serie</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Serie1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Primero&#39;</span><span class="p">,</span> <span class="s1">&#39;Segundo&#39;</span><span class="p">,</span> <span class="s1">&#39;Tercero&#39;</span><span class="p">,</span> <span class="s1">&#39;Cuarto&#39;</span><span class="p">,</span> <span class="s1">&#39;Quinto&#39;</span><span class="p">],</span>
 <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Variable1&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">Serie1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Primero    A
Segundo    B
Tercero    C
Cuarto     D
Quinto     E
Name: Variable1, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span> 
<span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Primero&#39;</span><span class="p">,</span> <span class="s1">&#39;Segundo&#39;</span><span class="p">,</span> <span class="s1">&#39;Tercero&#39;</span><span class="p">,</span> <span class="s1">&#39;Cuarto&#39;</span><span class="p">,</span> <span class="s1">&#39;Quinto&#39;</span><span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Variable2&quot;</span><span class="p">,</span><span class="s2">&quot;Variable3&quot;</span><span class="p">],</span> 
    <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;Hola&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Mi&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">],[</span><span class="s1">&#39;Nombre&#39;</span><span class="p">,</span><span class="mf">32.0</span><span class="p">],[</span><span class="s1">&#39;es&#39;</span><span class="p">,</span><span class="mi">42</span><span class="p">],[</span><span class="s1">&#39;frailejon&#39;</span><span class="p">,</span><span class="mi">52</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">Data_Frame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable2</th>
      <th>Variable3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Primero</th>
      <td>Hola</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>Segundo</th>
      <td>Mi</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>Tercero</th>
      <td>Nombre</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>Cuarto</th>
      <td>es</td>
      <td>42.0</td>
    </tr>
    <tr>
      <th>Quinto</th>
      <td>frailejon</td>
      <td>52.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para revisar el tipo de objeto que contiene nuestro DataFrame podemos ejecutar</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span><span class="o">.</span><span class="n">dtypes</span>
<span class="c1">#Serie1.dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variable2     object
Variable3    float64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Extraer datos sobre la base:</p>
<p>Si quiero conocer una columna de la base simplemente escribo <code class="docutils literal notranslate"><span class="pre">DataFrame['nombre_columna']</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;Variable3&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Primero    12.0
Segundo    22.0
Tercero    32.0
Cuarto     42.0
Quinto     52.0
Name: Variable3, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Para filtrar datos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DF_filtrado</span><span class="o">=</span><span class="n">Data_Frame</span><span class="p">[</span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;Variable2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Hola&#39;</span><span class="p">][[</span><span class="s1">&#39;Variable3&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DF_filtrado</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Primero</th>
      <td>12.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Para crear nuevas variables</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;Variable1&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable2</th>
      <th>Variable3</th>
      <th>Variable1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Primero</th>
      <td>Hola</td>
      <td>12.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Segundo</th>
      <td>Mi</td>
      <td>22.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Tercero</th>
      <td>Nombre</td>
      <td>32.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Cuarto</th>
      <td>es</td>
      <td>42.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Quinto</th>
      <td>frailejon</td>
      <td>52.0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si quiero ver varias columnas de la base de datos, utilizo doble paréntesis cuadrado:</p>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame[['columna1','columna2']]</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span><span class="p">[[</span><span class="s1">&#39;Variable1&#39;</span><span class="p">,</span><span class="s1">&#39;Variable2&#39;</span><span class="p">,</span><span class="s1">&#39;Variable1&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable1</th>
      <th>Variable2</th>
      <th>Variable1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Primero</th>
      <td>1</td>
      <td>Hola</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Segundo</th>
      <td>2</td>
      <td>Mi</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Tercero</th>
      <td>3</td>
      <td>Nombre</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Cuarto</th>
      <td>4</td>
      <td>es</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Quinto</th>
      <td>5</td>
      <td>frailejon</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si quiero ver datos por registros utilizo loc:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable2</th>
      <th>Variable3</th>
      <th>Variable1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Primero</th>
      <td>Hola</td>
      <td>12.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Tercero</th>
      <td>Nombre</td>
      <td>32.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Quinto</th>
      <td>frailejon</td>
      <td>52.0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span><span class="p">[</span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;Variable2&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;frailejon&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable2</th>
      <th>Variable3</th>
      <th>Variable1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Quinto</th>
      <td>frailejon</td>
      <td>52.0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;Variable2&#39;</span><span class="p">][</span><span class="s1">&#39;Quinto&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;Frailejon&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Data_Frame</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Data_Frame</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variable2    Hola
Variable3    12.0
Variable1       1
Name: Primero, dtype: object
Variable2      Mi
Variable3    22.0
Variable1       2
Name: Segundo, dtype: object
Variable2    Nombre
Variable3      32.0
Variable1         3
Name: Tercero, dtype: object
Variable2      es
Variable3    42.0
Variable1       4
Name: Cuarto, dtype: object
Variable2    Frailejon
Variable3         52.0
Variable1            5
Name: Quinto, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;Variable4&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;Variable3&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mf">12.0</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">52</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;VariableAux&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">Data_Frame</span><span class="p">[</span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;Variable4&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;A&#39;</span><span class="p">][</span><span class="s1">&#39;Variable3&#39;</span><span class="p">]</span>
<span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;VariableAux2&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">Data_Frame</span><span class="p">[</span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;Variable4&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;B&#39;</span><span class="p">][</span><span class="s1">&#39;Variable3&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span>
<span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;VariableAux&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;VariableAux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;VariableAux2&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;VariableAux2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;Variable3&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;VariableAux&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">Data_Frame</span><span class="p">[</span><span class="s1">&#39;VariableAux2&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_Frame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable2</th>
      <th>Variable3</th>
      <th>Variable1</th>
      <th>Variable4</th>
      <th>VariableAux</th>
      <th>VariableAux2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Primero</th>
      <td>Hola</td>
      <td>24.0</td>
      <td>1</td>
      <td>A</td>
      <td>24.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Segundo</th>
      <td>Mi</td>
      <td>44.0</td>
      <td>2</td>
      <td>A</td>
      <td>44.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Tercero</th>
      <td>Nombre</td>
      <td>16.0</td>
      <td>3</td>
      <td>B</td>
      <td>0.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>Cuarto</th>
      <td>es</td>
      <td>21.0</td>
      <td>4</td>
      <td>B</td>
      <td>0.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>Quinto</th>
      <td>Frailejon</td>
      <td>104.0</td>
      <td>5</td>
      <td>A</td>
      <td>104.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="carga-de-informacion-en-pandas">
<h3>Carga de información en <code class="docutils literal notranslate"><span class="pre">pandas</span></code><a class="headerlink" href="#carga-de-informacion-en-pandas" title="Link to this heading">#</a></h3>
<p>Para nuestro  ejercicio usaremos los siguientes conjuntos de datos alojados en <a class="reference external" href="https://github.com/Izainea/seminario-de-programacion/Cuadernos/datos_01">este enlace</a>:</p>
<ol class="arabic simple">
<li><p>NEW ENGLAND AREA.csv</p></li>
<li><p>ATLANTIC SOUTH AREA.csv</p></li>
<li><p>NEW YORK CITY AREA.csv</p></li>
<li><p>CHICAGO AREA.csv</p></li>
<li><p>NORTH FLORIDA AREA.csv</p></li>
<li><p>DC-MARYLAND-VIRGINIA AREA.csv</p></li>
<li><p>GREAT LAKES AREA.csv</p></li>
<li><p>NORTHWEST-ROCKY MOUNTAIN AREA.csv</p></li>
<li><p>MIDWEST AREA.csv</p></li>
<li><p>SOUTHWEST AREA.csv</p></li>
<li><p>LOS ANGELES AREA.csv</p></li>
<li><p>HOUSTON AREA.csv</p></li>
<li><p>CALIFORNIA NORTH AREA.csv</p></li>
<li><p>CENTRAL-SOUTH TEXAS AREA.csv</p></li>
<li><p>DALLAS AREA.csv</p></li>
<li><p>PHILADELPHIA AREA.csv</p></li>
<li><p>TENNESSEE AREA.csv</p></li>
<li><p>OHIO AREA.csv</p></li>
<li><p>SOUTH FLORIDA AREA.csv</p></li>
</ol>
<p>Cada uno de estos conjuntos de datos contiene la información de:</p>
<ol class="arabic simple">
<li><p><em>mou_Mean:</em> Número medio de minutos de uso mensuales</p></li>
<li><p><em>custcare_Mean:</em> Número medio de llamadas de atención al cliente</p></li>
<li><p><em>area:</em>  Área geografica</p></li>
<li><p><em>creditcd:</em> Indicador de tarjeta de crédito</p></li>
<li><p><em>eqpdays:</em> Número de días (antigüedad) del equipo actual</p></li>
</ol>
<p>Además, se incluye <em>Credito_dias.csv</em> con la información de 2 variables adicionales para los registros las cuales son:</p>
<ol class="arabic simple">
<li><p><em>creditcd:</em> Indicador de tarjeta de crédito</p></li>
<li><p><em>eqpdays:</em> Número de días (antigüedad) del equipo actual</p></li>
</ol>
<p>Revisaremos inicialmente los datos contenidos en <em>Credito_dias.csv</em> para revisar algunas funciones interesantes de <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, usaremos el comando</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;archivo.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Podemos definir el número de registros a imprimir usando</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">min_rows</span><span class="o">=</span><span class="mi">10</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Carga de datos
Si usa Google Colab o anaconda procure guardar todo lo que descarga en la carpeta de <code class="docutils literal notranslate"><span class="pre">datos_01</span></code> al mismo nivel de su cuaderno de practica, si utiliza este descargado desde [aquí](<a class="github reference external" href="https://github.com/izainea/seminario-de.programacion/Cuadernos/Minutos">izainea/seminario-de.programacion</a> y segundos.ipynb)</p>
<p>La estructura de la carpeta de trabajo debe ser así:</p>
</div>
<p>Minutos y segundos.ipynb
datos_01</p>
<ul class="simple">
<li><p>NEW ENGLAND AREA.csv</p></li>
<li><p>ATLANTIC SOUTH AREA.csv</p></li>
<li><p>NEW YORK CITY AREA.csv
…</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>Usando el paquete <code class="docutils literal notranslate"><span class="pre">os</span></code> identificaremos donde están nuestros archivos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="c1">#os.getcwd()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;.ipynb_checkpoints&#39;,
 &#39;Aprendizaje Automático.ipynb&#39;,
 &#39;Arboles de decisión.ipynb&#39;,
 &#39;bank_marketing.csv&#39;,
 &#39;Base Grande.csv&#39;,
 &#39;Clase 2&#39;,
 &#39;datos_01&#39;,
 &#39;Ejercicio K Means.ipynb&#39;,
 &#39;Estadisticos de Validación.ipynb&#39;,
 &#39;Graficos.ipynb&#39;,
 &#39;ifood_df.csv&#39;,
 &#39;images&#39;,
 &#39;Intro a Python y Pandas.md&#39;,
 &#39;introduccion.md&#39;,
 &#39;Manipulación, Limpieza y Exploración de Datos.ipynb&#39;,
 &#39;Medidas Estadisticas.ipynb&#39;,
 &#39;Minutos y segundos.ipynb&#39;,
 &#39;Modelos de Clasificación I.ipynb&#39;,
 &#39;Modelos de Clasificación II.ipynb&#39;,
 &#39;Visualización en Python.ipynb&#39;]
</pre></div>
</div>
</div>
</div>
<p>Como asumimos que todo se guardó en la carpeta <code class="docutils literal notranslate"><span class="pre">datos_01</span></code>, tenemos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;datos_01&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ATLANTIC SOUTH AREA.csv&#39;,
 &#39;CALIFORNIA NORTH AREA.csv&#39;,
 &#39;CENTRAL-SOUTH TEXAS AREA.csv&#39;,
 &#39;CHICAGO AREA.csv&#39;,
 &#39;Credito_dias.csv&#39;,
 &#39;DALLAS AREA.csv&#39;,
 &#39;DC-MARYLAND-VIRGINIA AREA.csv&#39;,
 &#39;GREAT LAKES AREA.csv&#39;,
 &#39;HOUSTON AREA.csv&#39;,
 &#39;LOS ANGELES AREA.csv&#39;,
 &#39;MIDWEST AREA.csv&#39;,
 &#39;NEW ENGLAND AREA.csv&#39;,
 &#39;NEW YORK CITY AREA.csv&#39;,
 &#39;NORTH FLORIDA AREA.csv&#39;,
 &#39;NORTHWEST-ROCKY MOUNTAIN AREA.csv&#39;,
 &#39;OHIO AREA.csv&#39;,
 &#39;PHILADELPHIA AREA.csv&#39;,
 &#39;SOUTH FLORIDA AREA.csv&#39;,
 &#39;SOUTHWEST AREA.csv&#39;,
 &#39;TENNESSEE AREA.csv&#39;]
</pre></div>
</div>
</div>
</div>
<p>Como sabemos donde esta el archivo, lo cargamos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datos_01/Credito_dias.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;Customer_ID&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
    <tr>
      <th>Customer_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1082423</th>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
    </tr>
    <tr>
      <th>1069232</th>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83</td>
    </tr>
    <tr>
      <th>1031705</th>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675</td>
    </tr>
    <tr>
      <th>1089806</th>
      <td>1863.0</td>
      <td>294.26</td>
      <td>Y</td>
      <td>218</td>
    </tr>
    <tr>
      <th>1076695</th>
      <td>4155.0</td>
      <td>433.16</td>
      <td>N</td>
      <td>222</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1027614</th>
      <td>2570.0</td>
      <td>484.31</td>
      <td>Y</td>
      <td>611</td>
    </tr>
    <tr>
      <th>1098422</th>
      <td>2105.0</td>
      <td>583.36</td>
      <td>Y</td>
      <td>1243</td>
    </tr>
    <tr>
      <th>1096497</th>
      <td>3690.0</td>
      <td>294.29</td>
      <td>Y</td>
      <td>212</td>
    </tr>
    <tr>
      <th>1087248</th>
      <td>3333.0</td>
      <td>233.08</td>
      <td>Y</td>
      <td>290</td>
    </tr>
    <tr>
      <th>1099003</th>
      <td>5025.0</td>
      <td>1436.49</td>
      <td>Y</td>
      <td>1029</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 4 columns</p>
</div></div></div>
</div>
<p>El conjunto de datos se encuentra en el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> <code class="docutils literal notranslate"><span class="pre">df</span></code></p>
<p>sobre el objeto creado podemos usar  algunas funciones  para darnos una idea del comportamiento de la información:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># imprime los primeros n registros del DataFrame</span>
<span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># imprime los últimos n registros del DataFrame </span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>    <span class="c1"># imprime el numero de columnas y filas del DataFrame</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span>  <span class="c1"># imprime el nombre de las columnas del DataFrame</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span>    <span class="c1"># imprime el indice de los registros del DataFrame</span>
<span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>   <span class="c1"># imprime el tipo de cada una de las columnnas del DataFrame</span>
<span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="c1"># imprime una muestra aleatoria de n registros en el DataFrame</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 10000 entries, 1082423 to 1099003
Data columns (total 4 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   totmou    10000 non-null  float64
 1   totrev    10000 non-null  float64
 2   creditcd  9848 non-null   object 
 3   eqpdays   10000 non-null  int64  
dtypes: float64(2), int64(1), object(1)
memory usage: 390.6+ KB
</pre></div>
</div>
</div>
</div>
<p>Veamos información relevante de la variable <code class="docutils literal notranslate"><span class="pre">totmou</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;totmou&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Customer_ID
1082423     7269.0
1069232    13552.0
1031705     4152.0
1089806     1863.0
1076695     4155.0
            ...   
1027614     2570.0
1098422     2105.0
1096497     3690.0
1087248     3333.0
1099003     5025.0
Name: totmou, Length: 10000, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;totmou&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7692.8048656727005
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>9848</td>
      <td>10000.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Y</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>6796</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>7692.804866</td>
      <td>1042.133807</td>
      <td>NaN</td>
      <td>386.794500</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8657.917883</td>
      <td>857.144895</td>
      <td>NaN</td>
      <td>252.720196</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>11.100000</td>
      <td>NaN</td>
      <td>-5.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2576.000000</td>
      <td>526.787500</td>
      <td>NaN</td>
      <td>210.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5262.000000</td>
      <td>820.235000</td>
      <td>NaN</td>
      <td>338.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>9823.250000</td>
      <td>1272.975000</td>
      <td>NaN</td>
      <td>522.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>163264.176700</td>
      <td>13426.600000</td>
      <td>NaN</td>
      <td>1823.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s2">&quot;primeros 3 registros&quot;</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="s2">&quot;3 últimos registros&quot;</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="s2">&quot;Columnas:&quot;</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="s2">&quot;Índices:&quot;</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="s2">&quot;Tipos de registros en el DataFrame&quot;</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="s2">&quot;Muestra aleatoria de 3 registros&quot;</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="s2">&quot;dimensión&quot;</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;primeros 3 registros&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
    <tr>
      <th>Customer_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1082423</th>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
    </tr>
    <tr>
      <th>1069232</th>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83</td>
    </tr>
    <tr>
      <th>1031705</th>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;3 últimos registros&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
    <tr>
      <th>Customer_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1096497</th>
      <td>3690.0</td>
      <td>294.29</td>
      <td>Y</td>
      <td>212</td>
    </tr>
    <tr>
      <th>1087248</th>
      <td>3333.0</td>
      <td>233.08</td>
      <td>Y</td>
      <td>290</td>
    </tr>
    <tr>
      <th>1099003</th>
      <td>5025.0</td>
      <td>1436.49</td>
      <td>Y</td>
      <td>1029</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Columnas:&#39;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;totmou&#39;, &#39;totrev&#39;, &#39;creditcd&#39;, &#39;eqpdays&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Índices:&#39;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([1082423, 1069232, 1031705, 1089806, 1076695, 1091652, 1043846, 1088967,
       1045239, 1046584,
       ...
       1087145, 1002540, 1044082, 1083458, 1093976, 1027614, 1098422, 1096497,
       1087248, 1099003],
      dtype=&#39;int64&#39;, name=&#39;Customer_ID&#39;, length=10000)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Tipos de registros en el DataFrame&#39;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>totmou      float64
totrev      float64
creditcd     object
eqpdays       int64
dtype: object
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Muestra aleatoria de 3 registros&#39;
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
    <tr>
      <th>Customer_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1006644</th>
      <td>5195.0</td>
      <td>1059.79</td>
      <td>N</td>
      <td>696</td>
    </tr>
    <tr>
      <th>1087481</th>
      <td>7429.0</td>
      <td>549.40</td>
      <td>N</td>
      <td>350</td>
    </tr>
    <tr>
      <th>1029193</th>
      <td>3974.0</td>
      <td>640.14</td>
      <td>Y</td>
      <td>193</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;dimensión&#39;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10000, 4)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">creditcd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Customer_ID
1082423    Y
1069232    N
1031705    Y
1089806    Y
1076695    N
          ..
1027614    Y
1098422    Y
1096497    Y
1087248    Y
1099003    Y
Name: creditcd, Length: 10000, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Este conjunto de datos corresponde a 10000 registros y 2 variables</p>
</section>
<section id="manejo-de-datos-duplicados">
<h3>Manejo de datos duplicados<a class="headerlink" href="#manejo-de-datos-duplicados" title="Link to this heading">#</a></h3>
<p>os dataframes tienen la posibilidad de detectar las filas duplicadas con la función:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">({</span><span class="n">columns</span><span class="p">})</span>
</pre></div>
</div>
<p>Si no especifica {columns}, se busacarán duplicados teniendo en cuenta todas las columnas. Una vez detectados el dtaframe tiene un función para eliminar filas duplicadas, haciendo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
<p>También es posible eliminar filas que duplican solo algunos campos. Con el fin de dejar solo una ocurrencia.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s1">&#39;nombre&#39;</span><span class="p">,</span> <span class="s1">&#39;apellido&#39;</span><span class="p">,</span> <span class="s1">&#39;cédula&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>En este caso, como no todas las colomnas son iguales se conserva solo la última ocurrencia.</p>
</section>
<section id="manejo-de-datos-perdidos-o-esperados">
<h3>Manejo de datos perdidos o esperados<a class="headerlink" href="#manejo-de-datos-perdidos-o-esperados" title="Link to this heading">#</a></h3>
<p>Son aquellos datos flatantes en la tabla que por alguna razón o error no se encuentran, o parecen con algún valor o etiqueta de no válido.
Para manipular datos perdidos use la explicación dada el siguiente enlace: <a class="reference external" href="http://ligdigonzalez.com/manipulando-datos-perdidos-en-python/">DATOS PERDIDOS</a>
recuerde que para reemplazar datos perdidos en un dataframe <span class="math notranslate nohighlight">\(df\)</span> se usa la función:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">promedio</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;totrev&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;nota&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">promedio</span><span class="p">)</span>
</pre></div>
</div>
<p>en donde la opción ‘promedio’ busca el valor promedio de la columna (datos numéricos) o la moda (datos categóricos) para reemplazar el valor no válido.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>totmou      False
totrev      False
creditcd     True
eqpdays     False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perd</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">perd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Customer_ID
1082423    False
1069232    False
1031705    False
1089806    False
1076695    False
           ...  
1027614    False
1098422    False
1096497    False
1087248    False
1099003    False
Length: 10000, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>range(0, 10000)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([1082423, 1069232, 1031705, 1089806, 1076695, 1091652, 1043846, 1088967,
       1045239, 1046584,
       ...
       1087145, 1002540, 1044082, 1083458, 1093976, 1027614, 1098422, 1096497,
       1087248, 1099003],
      dtype=&#39;int64&#39;, name=&#39;Customer_ID&#39;, length=10000)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">10</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1082423
1069232
1031705
1089806
1076695
1091652
1043846
1088967
1045239
1046584
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">perd</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
    <tr>
      <th>Customer_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1072218</th>
      <td>5684.0</td>
      <td>857.65</td>
      <td>NaN</td>
      <td>244</td>
    </tr>
    <tr>
      <th>1066597</th>
      <td>925.0</td>
      <td>373.12</td>
      <td>NaN</td>
      <td>344</td>
    </tr>
    <tr>
      <th>1023352</th>
      <td>14466.0</td>
      <td>2243.76</td>
      <td>NaN</td>
      <td>387</td>
    </tr>
    <tr>
      <th>1045521</th>
      <td>2504.0</td>
      <td>756.79</td>
      <td>NaN</td>
      <td>495</td>
    </tr>
    <tr>
      <th>1001813</th>
      <td>76260.0</td>
      <td>5526.11</td>
      <td>NaN</td>
      <td>361</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1050795</th>
      <td>15591.0</td>
      <td>1330.71</td>
      <td>NaN</td>
      <td>447</td>
    </tr>
    <tr>
      <th>1096985</th>
      <td>3011.0</td>
      <td>522.14</td>
      <td>NaN</td>
      <td>74</td>
    </tr>
    <tr>
      <th>1025203</th>
      <td>853.0</td>
      <td>650.34</td>
      <td>NaN</td>
      <td>780</td>
    </tr>
    <tr>
      <th>1099258</th>
      <td>33660.0</td>
      <td>4247.85</td>
      <td>NaN</td>
      <td>206</td>
    </tr>
    <tr>
      <th>1026149</th>
      <td>1955.0</td>
      <td>606.08</td>
      <td>NaN</td>
      <td>770</td>
    </tr>
  </tbody>
</table>
<p>152 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">perdidos</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">perdidos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
    <tr>
      <th>Customer_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1072218</th>
      <td>5684.0</td>
      <td>857.65</td>
      <td>NaN</td>
      <td>244</td>
    </tr>
    <tr>
      <th>1066597</th>
      <td>925.0</td>
      <td>373.12</td>
      <td>NaN</td>
      <td>344</td>
    </tr>
    <tr>
      <th>1023352</th>
      <td>14466.0</td>
      <td>2243.76</td>
      <td>NaN</td>
      <td>387</td>
    </tr>
    <tr>
      <th>1045521</th>
      <td>2504.0</td>
      <td>756.79</td>
      <td>NaN</td>
      <td>495</td>
    </tr>
    <tr>
      <th>1001813</th>
      <td>76260.0</td>
      <td>5526.11</td>
      <td>NaN</td>
      <td>361</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1050795</th>
      <td>15591.0</td>
      <td>1330.71</td>
      <td>NaN</td>
      <td>447</td>
    </tr>
    <tr>
      <th>1096985</th>
      <td>3011.0</td>
      <td>522.14</td>
      <td>NaN</td>
      <td>74</td>
    </tr>
    <tr>
      <th>1025203</th>
      <td>853.0</td>
      <td>650.34</td>
      <td>NaN</td>
      <td>780</td>
    </tr>
    <tr>
      <th>1099258</th>
      <td>33660.0</td>
      <td>4247.85</td>
      <td>NaN</td>
      <td>206</td>
    </tr>
    <tr>
      <th>1026149</th>
      <td>1955.0</td>
      <td>606.08</td>
      <td>NaN</td>
      <td>770</td>
    </tr>
  </tbody>
</table>
<p>152 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;creditcd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>creditcd
Y      6796
N      3052
NaN     152
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">promedio</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;totrev&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;totrev&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;totrev&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">promedio</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>También es recomendado usar la funcion <code class="docutils literal notranslate"><span class="pre">fillna()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;creditcd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 10000 entries, 1082423 to 1099003
Data columns (total 4 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   totmou    10000 non-null  float64
 1   totrev    10000 non-null  float64
 2   creditcd  10000 non-null  object 
 3   eqpdays   10000 non-null  int64  
dtypes: float64(2), int64(1), object(1)
memory usage: 390.6+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>totmou      False
totrev      False
creditcd    False
eqpdays     False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
    <tr>
      <th>Customer_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1082423</th>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
    </tr>
    <tr>
      <th>1069232</th>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83</td>
    </tr>
    <tr>
      <th>1031705</th>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675</td>
    </tr>
    <tr>
      <th>1089806</th>
      <td>1863.0</td>
      <td>294.26</td>
      <td>Y</td>
      <td>218</td>
    </tr>
    <tr>
      <th>1076695</th>
      <td>4155.0</td>
      <td>433.16</td>
      <td>N</td>
      <td>222</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1027614</th>
      <td>2570.0</td>
      <td>484.31</td>
      <td>Y</td>
      <td>611</td>
    </tr>
    <tr>
      <th>1098422</th>
      <td>2105.0</td>
      <td>583.36</td>
      <td>Y</td>
      <td>1243</td>
    </tr>
    <tr>
      <th>1096497</th>
      <td>3690.0</td>
      <td>294.29</td>
      <td>Y</td>
      <td>212</td>
    </tr>
    <tr>
      <th>1087248</th>
      <td>3333.0</td>
      <td>233.08</td>
      <td>Y</td>
      <td>290</td>
    </tr>
    <tr>
      <th>1099003</th>
      <td>5025.0</td>
      <td>1436.49</td>
      <td>Y</td>
      <td>1029</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;creditcd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>creditcd
Y    6948
N    3052
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculo-de-estadisticas-resumen">
<h3>Cálculo de estadísticas resumen<a class="headerlink" href="#calculo-de-estadisticas-resumen" title="Link to this heading">#</a></h3>
<p>Las medidas estadísticas resumen son de gran ayuda para comprender como es el comportamiento de la distribución de los datos, los objetos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> ofrecen facilidades para hacer el cálculo de algunas estadísticas sobre cada una de las variables.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="c1"># Encuentra la frecuencia de las categorias de una columna (la columna debe ser cualitativa)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>          <span class="c1"># Encuentra el mínimo de una variable cuantitativa</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>       <span class="c1"># Encuentra el mínimo de una variable cuantitativa</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>         <span class="c1"># Encuentra el promedio de una variable cuantitativa</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>          <span class="c1"># Encuentra el máximo de una variable cuantitativa</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">()</span>     <span class="c1"># Encuentra los cuantiles de una variable cuantitativa</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;creditcd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>creditcd
Y    6948
N    3052
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;creditcd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;eqpdays&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;eqpdays&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;eqpdays&quot;</span><span class="p">]</span> <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;eqpdays&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>La exploración del anterior resultado puede mostrar inconsistencias  en los registros y nos ayudará a tomar decisiones sobre algunos registros, el valor mínimo de la variable <code class="docutils literal notranslate"><span class="pre">eqpdays</span></code> (Número de días (antigüedad) del equipo actual) debería ser estrictamente positivo y estos pueden ser errores de ingreso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;eqpdays&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1823
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;eqpdays&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>338.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;eqpdays&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>386.7992
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;eqpdays&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>210.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;eqpdays&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>522.0
</pre></div>
</div>
</div>
</div>
<p>Estas estadísticas pueden ser resumidas con el comando:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>  <span class="c1"># Estadísticas resumen principales</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;eqpdays&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    10000.00000
mean       386.79920
std        252.71297
min          0.00000
25%        210.00000
50%        338.00000
75%        522.00000
max       1823.00000
Name: eqpdays, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;creditcd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     10000
unique        2
top           Y
freq       6948
Name: creditcd, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totmou</th>
      <th>totrev</th>
      <th>eqpdays</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.00000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>7692.804866</td>
      <td>1042.133807</td>
      <td>386.79920</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8657.917883</td>
      <td>857.144895</td>
      <td>252.71297</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>11.100000</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2576.000000</td>
      <td>526.787500</td>
      <td>210.00000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5262.000000</td>
      <td>820.235000</td>
      <td>338.00000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>9823.250000</td>
      <td>1272.975000</td>
      <td>522.00000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>163264.176700</td>
      <td>13426.600000</td>
      <td>1823.00000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000</td>
      <td>10000.00000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Y</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>6948</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>7692.804866</td>
      <td>1042.133807</td>
      <td>NaN</td>
      <td>386.79920</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8657.917883</td>
      <td>857.144895</td>
      <td>NaN</td>
      <td>252.71297</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>11.100000</td>
      <td>NaN</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2576.000000</td>
      <td>526.787500</td>
      <td>NaN</td>
      <td>210.00000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5262.000000</td>
      <td>820.235000</td>
      <td>NaN</td>
      <td>338.00000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>9823.250000</td>
      <td>1272.975000</td>
      <td>NaN</td>
      <td>522.00000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>163264.176700</td>
      <td>13426.600000</td>
      <td>NaN</td>
      <td>1823.00000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="agregar-informacion-de-multiples-tablas">
<h3>Agregar información de múltiples tablas<a class="headerlink" href="#agregar-informacion-de-multiples-tablas" title="Link to this heading">#</a></h3>
<p>Hemos desarrollado un breve resumen estadístico solamente usando la base <code class="docutils literal notranslate"><span class="pre">Credito_dias.csv</span></code>. Realizaremos la combinación de las 19 áreas que nos reportan en los archivos csv. Una forma de lograr esta tarea de agregación es usar el método pd.concat() de pandas. Una entrada en este método puede ser una lista de DataFrames que quiera concatenar. Usaremos un ciclo  <code class="docutils literal notranslate"><span class="pre">for</span></code> sobre cada uno de los archivos de áreas para</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>totmou      float64
totrev      float64
creditcd     object
eqpdays       int64
dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="ejercicio-1">
<h3>Ejercicio 1<a class="headerlink" href="#ejercicio-1" title="Link to this heading">#</a></h3>
<p>Determinar los percentiles 25, 50 y 75 para las columnas ttomou, totrev, eqpdays</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Espacio para el desarrollo del ejercicio</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;totmou&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     10000.000000
mean       7692.804866
std        8657.917883
min           0.000000
25%        2576.000000
50%        5262.000000
75%        9823.250000
max      163264.176700
Name: totmou, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;totrev&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    10000.000000
mean      1042.133807
std        857.144895
min         11.100000
25%        526.787500
50%        820.235000
75%       1272.975000
max      13426.600000
Name: totrev, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000</td>
      <td>10000.00000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Y</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>6948</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>7692.804866</td>
      <td>1042.133807</td>
      <td>NaN</td>
      <td>386.79920</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8657.917883</td>
      <td>857.144895</td>
      <td>NaN</td>
      <td>252.71297</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>11.100000</td>
      <td>NaN</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2576.000000</td>
      <td>526.787500</td>
      <td>NaN</td>
      <td>210.00000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5262.000000</td>
      <td>820.235000</td>
      <td>NaN</td>
      <td>338.00000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>9823.250000</td>
      <td>1272.975000</td>
      <td>NaN</td>
      <td>522.00000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>163264.176700</td>
      <td>13426.600000</td>
      <td>NaN</td>
      <td>1823.00000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">areas</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;datos_01&quot;</span><span class="p">))</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">areas</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;.ipynb_checkpoints&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">areas</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;Credito_dias.csv&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="n">areas</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">areas</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="p">]</span>
<span class="n">areas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ATLANTIC SOUTH AREA.csv&#39;,
 &#39;CALIFORNIA NORTH AREA.csv&#39;,
 &#39;CENTRAL-SOUTH TEXAS AREA.csv&#39;,
 &#39;CHICAGO AREA.csv&#39;,
 &#39;DALLAS AREA.csv&#39;,
 &#39;DC-MARYLAND-VIRGINIA AREA.csv&#39;,
 &#39;GREAT LAKES AREA.csv&#39;,
 &#39;HOUSTON AREA.csv&#39;,
 &#39;LOS ANGELES AREA.csv&#39;,
 &#39;MIDWEST AREA.csv&#39;,
 &#39;NEW ENGLAND AREA.csv&#39;,
 &#39;NEW YORK CITY AREA.csv&#39;,
 &#39;NORTH FLORIDA AREA.csv&#39;,
 &#39;NORTHWEST-ROCKY MOUNTAIN AREA.csv&#39;,
 &#39;OHIO AREA.csv&#39;,
 &#39;PHILADELPHIA AREA.csv&#39;,
 &#39;SOUTH FLORIDA AREA.csv&#39;,
 &#39;SOUTHWEST AREA.csv&#39;,
 &#39;TENNESSEE AREA.csv&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Definición de los símbolos de las acciones&quot;</span><span class="p">)</span>

<span class="n">lista_de_df</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Bucle sobre los símbolos</span>
<span class="c1">#print(&quot; --- Inicie el bucle sobre los símbolos --- &quot;)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">areas</span><span class="p">:</span>
    <span class="c1">## ruta completa</span>
    <span class="n">i</span><span class="o">=</span><span class="s1">&#39;datos_01/&#39;</span><span class="o">+</span><span class="n">i</span>
    <span class="c1">#print(&quot;Procesando el símbolo: &quot; + i)</span>
    <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;Customer_ID&quot;</span><span class="p">)</span>
    <span class="n">temp_df</span><span class="p">[</span><span class="s2">&quot;area&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">lista_de_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_df</span><span class="p">)</span>
    <span class="c1"># Usando un salto de línea al final de esta cadena de caracteres por estética</span>
   <span class="c1"># print(&quot; --- Bucle completo sobre los símbolos --- \n&quot;)</span>
    <span class="c1"># Combinando en un solo DataFrame usando el concat</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Agregando los datos&quot;</span><span class="p">)</span>
<span class="n">agr_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">lista_de_df</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">agr_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cabeza del DataFrame agr_df: &quot;</span><span class="p">)</span>
<span class="n">agr_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Definición de los símbolos de las acciones
Agregando los datos
(9997, 4)
Cabeza del DataFrame agr_df: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd</th>
    </tr>
    <tr>
      <th>Customer_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1069232</th>
      <td>3.666667</td>
      <td>U</td>
      <td>datos_01/ATLANTIC SOUTH AREA.csv</td>
      <td>N</td>
    </tr>
    <tr>
      <th>1043846</th>
      <td>0.000000</td>
      <td>U</td>
      <td>datos_01/ATLANTIC SOUTH AREA.csv</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1008539</th>
      <td>0.000000</td>
      <td>N</td>
      <td>datos_01/ATLANTIC SOUTH AREA.csv</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1068315</th>
      <td>0.000000</td>
      <td>U</td>
      <td>datos_01/ATLANTIC SOUTH AREA.csv</td>
      <td>N</td>
    </tr>
    <tr>
      <th>1074220</th>
      <td>1.666667</td>
      <td>U</td>
      <td>datos_01/ATLANTIC SOUTH AREA.csv</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">texto</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;datos_01/&quot;</span>
<span class="n">agr_df</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">agr_df</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">texto</span> <span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; AREA.csv&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agr_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd</th>
    </tr>
    <tr>
      <th>Customer_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1069232</th>
      <td>3.666667</td>
      <td>U</td>
      <td>ATLANTIC SOUTH</td>
      <td>N</td>
    </tr>
    <tr>
      <th>1043846</th>
      <td>0.000000</td>
      <td>U</td>
      <td>ATLANTIC SOUTH</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1008539</th>
      <td>0.000000</td>
      <td>N</td>
      <td>ATLANTIC SOUTH</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1068315</th>
      <td>0.000000</td>
      <td>U</td>
      <td>ATLANTIC SOUTH</td>
      <td>N</td>
    </tr>
    <tr>
      <th>1074220</th>
      <td>1.666667</td>
      <td>U</td>
      <td>ATLANTIC SOUTH</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1093180</th>
      <td>3.000000</td>
      <td>U</td>
      <td>TENNESSEE</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1018795</th>
      <td>0.000000</td>
      <td>U</td>
      <td>TENNESSEE</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1055110</th>
      <td>9.666667</td>
      <td>U</td>
      <td>TENNESSEE</td>
      <td>N</td>
    </tr>
    <tr>
      <th>1078247</th>
      <td>0.333333</td>
      <td>U</td>
      <td>TENNESSEE</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1061746</th>
      <td>0.000000</td>
      <td>U</td>
      <td>TENNESSEE</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
<p>9997 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agr_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">agr_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;Base Grande.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
    <tr>
      <th>Customer_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1082423</th>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
    </tr>
    <tr>
      <th>1069232</th>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83</td>
    </tr>
    <tr>
      <th>1031705</th>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675</td>
    </tr>
    <tr>
      <th>1089806</th>
      <td>1863.0</td>
      <td>294.26</td>
      <td>Y</td>
      <td>218</td>
    </tr>
    <tr>
      <th>1076695</th>
      <td>4155.0</td>
      <td>433.16</td>
      <td>N</td>
      <td>222</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1027614</th>
      <td>2570.0</td>
      <td>484.31</td>
      <td>Y</td>
      <td>611</td>
    </tr>
    <tr>
      <th>1098422</th>
      <td>2105.0</td>
      <td>583.36</td>
      <td>Y</td>
      <td>1243</td>
    </tr>
    <tr>
      <th>1096497</th>
      <td>3690.0</td>
      <td>294.29</td>
      <td>Y</td>
      <td>212</td>
    </tr>
    <tr>
      <th>1087248</th>
      <td>3333.0</td>
      <td>233.08</td>
      <td>Y</td>
      <td>290</td>
    </tr>
    <tr>
      <th>1099003</th>
      <td>5025.0</td>
      <td>1436.49</td>
      <td>Y</td>
      <td>1029</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agr_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd</th>
    </tr>
    <tr>
      <th>Customer_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1000014</th>
      <td>0.000000</td>
      <td>Y</td>
      <td>CENTRAL-SOUTH TEXAS</td>
      <td>N</td>
    </tr>
    <tr>
      <th>1000016</th>
      <td>1.000000</td>
      <td>N</td>
      <td>DALLAS</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1000021</th>
      <td>0.333333</td>
      <td>U</td>
      <td>TENNESSEE</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1000023</th>
      <td>0.000000</td>
      <td>N</td>
      <td>NORTHWEST-ROCKY MOUNTAIN</td>
      <td>N</td>
    </tr>
    <tr>
      <th>1000029</th>
      <td>0.000000</td>
      <td>N</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1099907</th>
      <td>17.333333</td>
      <td>U</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1099932</th>
      <td>0.000000</td>
      <td>U</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1099963</th>
      <td>0.000000</td>
      <td>U</td>
      <td>SOUTHWEST</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1099981</th>
      <td>0.333333</td>
      <td>U</td>
      <td>SOUTHWEST</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1099992</th>
      <td>0.000000</td>
      <td>Y</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
<p>9997 rows × 4 columns</p>
</div></div></div>
</div>
<p>La ejecución nos da como resultado una base de datos de 9997 registros correspondiente a la concatenación de todas las áreas. Se debe notar que nuestro conjunto de datos también es indexado por la columna <code class="docutils literal notranslate"><span class="pre">Customer_ID</span></code> y que la dimensión de los registros de está nueva base es menor a la de  <code class="docutils literal notranslate"><span class="pre">Creditos_dias.csv</span></code>.</p>
</section>
</section>
<section id="cruce-de-informacion">
<h2>Cruce de información<a class="headerlink" href="#cruce-de-informacion" title="Link to this heading">#</a></h2>
<p>El cruce de información es una operación esencial en el análisis de los datos. Usualmente, la posibilidad de realizar el cruce de dos o más fuentes de información es el primer paso para responder preguntas complejas acerca de los datos. Existen muchas formas de cruzar o combinar tablas de datos. El cruce de estos datos siempre tiene un propósito. Por tanto, se debe realizar un análisis de lo que se requiere antes de iniciar. Para esto, lo primero es conocer bien las fuentes de información que se van a relacionar.</p>
<section id="uniones-joins">
<h3>Uniones (Joins)<a class="headerlink" href="#uniones-joins" title="Link to this heading">#</a></h3>
<p>Usando la librería pandas se pueden realizar 4 tipos de uniones para cruzar información entre dos fuentes de datos, ver Figura abajo.</p>
<ul class="simple">
<li><p>INNER JOIN: este tipo de cruce incluye solo los resgistros que coincieden en las dos tablas</p></li>
<li><p>LEFT JOIN:  en este tipo de cruce se incluyen todos los registros de la primera tabla aunque no aparezcan coincidencias en la segunda. Cuando no hay coincidencias en la segunda tabla los campos correspondientes a esta aparecerán como nulos.</p></li>
<li><p>RIGHT JOIN: en este tipo de cruce se incluyen todos los registros de la segunda tabla aunque no aparezcan coincidencias en la primera. Cuando no hay coincidencias en la primer tabla los campos correspondientes a esta aparecerán como nulos.</p></li>
<li><p>OUTER JOIN O FULL JOIN: combina todos los registros de ambas tablas aunque no existan coincidencias en la otra tabla.</p></li>
</ul>
<p><img alt="Los tipos de uniones que se pueden ejecutar en pandas" src="https://letsdobigdata.files.wordpress.com/2016/03/joins.png" /></p>
<p>La combinación a usar depende del análisis que se requiera con los datos. Lo más común es realizar un cruce de tipo Inner Join, debido a que muestra los registros cuando aparecen relacionados en ambas tablas. Sin embargo, en
ocasiones se quiere saber que pasa con todos los registros de la primera tabla aunque no se tengan coincidencias. Alternativamente, quizá, lo menos usual es hacer combinaciones de tipo RIGHT o OUTER. Generalmente, estas son usadas cuando se quiere saber por qué no se tienen coincidencias, o cuáles registros no cumplen con la relación especificada.</p>
<p>Ya que desconocemos cuales son los registros perdidos en los 2 dataframes que hemos construido y es necesario para continuar nuestro preprocesamiento el unir la información.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agr_df</span><span class="o">=</span><span class="n">agr_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">agr_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000014</td>
      <td>0.000000</td>
      <td>Y</td>
      <td>CENTRAL-SOUTH TEXAS</td>
      <td>N</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000016</td>
      <td>1.000000</td>
      <td>N</td>
      <td>DALLAS</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000021</td>
      <td>0.333333</td>
      <td>U</td>
      <td>TENNESSEE</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000023</td>
      <td>0.000000</td>
      <td>N</td>
      <td>NORTHWEST-ROCKY MOUNTAIN</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000029</td>
      <td>0.000000</td>
      <td>N</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9992</th>
      <td>1099907</td>
      <td>17.333333</td>
      <td>U</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9993</th>
      <td>1099932</td>
      <td>0.000000</td>
      <td>U</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9994</th>
      <td>1099963</td>
      <td>0.000000</td>
      <td>U</td>
      <td>SOUTHWEST</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>1099981</td>
      <td>0.333333</td>
      <td>U</td>
      <td>SOUTHWEST</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>1099992</td>
      <td>0.000000</td>
      <td>Y</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
<p>9997 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082423</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1069232</td>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1031705</td>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1089806</td>
      <td>1863.0</td>
      <td>294.26</td>
      <td>Y</td>
      <td>218</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1076695</td>
      <td>4155.0</td>
      <td>433.16</td>
      <td>N</td>
      <td>222</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>1027614</td>
      <td>2570.0</td>
      <td>484.31</td>
      <td>Y</td>
      <td>611</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>1098422</td>
      <td>2105.0</td>
      <td>583.36</td>
      <td>Y</td>
      <td>1243</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>1096497</td>
      <td>3690.0</td>
      <td>294.29</td>
      <td>Y</td>
      <td>212</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>1087248</td>
      <td>3333.0</td>
      <td>233.08</td>
      <td>Y</td>
      <td>290</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>1099003</td>
      <td>5025.0</td>
      <td>1436.49</td>
      <td>Y</td>
      <td>1029</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df2</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">10</span><span class="p">]:</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082433</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1069242</td>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1031715</td>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1089816</td>
      <td>1863.0</td>
      <td>294.26</td>
      <td>Y</td>
      <td>218</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1076705</td>
      <td>4155.0</td>
      <td>433.16</td>
      <td>N</td>
      <td>222</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1091662</td>
      <td>5441.0</td>
      <td>578.80</td>
      <td>Y</td>
      <td>68</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1043856</td>
      <td>7294.0</td>
      <td>1495.18</td>
      <td>Y</td>
      <td>460</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1088977</td>
      <td>4395.0</td>
      <td>668.23</td>
      <td>N</td>
      <td>333</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1045249</td>
      <td>11544.0</td>
      <td>1012.64</td>
      <td>Y</td>
      <td>498</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1046594</td>
      <td>3751.0</td>
      <td>1199.89</td>
      <td>Y</td>
      <td>592</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DF_Derecha</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">agr_df</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">)</span>
<span class="n">DF_Derecha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000014</td>
      <td>642.00000</td>
      <td>1370.94</td>
      <td>N</td>
      <td>354.0</td>
      <td>0.000000</td>
      <td>Y</td>
      <td>CENTRAL-SOUTH TEXAS</td>
      <td>N</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000016</td>
      <td>15226.03000</td>
      <td>2311.08</td>
      <td>Y</td>
      <td>697.0</td>
      <td>1.000000</td>
      <td>N</td>
      <td>DALLAS</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000021</td>
      <td>79406.01667</td>
      <td>6751.70</td>
      <td>Y</td>
      <td>143.0</td>
      <td>0.333333</td>
      <td>U</td>
      <td>TENNESSEE</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000023</td>
      <td>64174.80667</td>
      <td>7419.73</td>
      <td>N</td>
      <td>350.0</td>
      <td>0.000000</td>
      <td>N</td>
      <td>NORTHWEST-ROCKY MOUNTAIN</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000029</td>
      <td>42715.00000</td>
      <td>3829.33</td>
      <td>Y</td>
      <td>183.0</td>
      <td>0.000000</td>
      <td>N</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9992</th>
      <td>1099907</td>
      <td>17843.00000</td>
      <td>1457.01</td>
      <td>Y</td>
      <td>184.0</td>
      <td>17.333333</td>
      <td>U</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9993</th>
      <td>1099932</td>
      <td>14079.00000</td>
      <td>1538.55</td>
      <td>Y</td>
      <td>275.0</td>
      <td>0.000000</td>
      <td>U</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9994</th>
      <td>1099963</td>
      <td>9722.00000</td>
      <td>1559.16</td>
      <td>Y</td>
      <td>946.0</td>
      <td>0.000000</td>
      <td>U</td>
      <td>SOUTHWEST</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>1099981</td>
      <td>7248.00000</td>
      <td>1417.30</td>
      <td>Y</td>
      <td>882.0</td>
      <td>0.333333</td>
      <td>U</td>
      <td>SOUTHWEST</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>1099992</td>
      <td>7338.00000</td>
      <td>1198.48</td>
      <td>Y</td>
      <td>773.0</td>
      <td>0.000000</td>
      <td>Y</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
<p>9997 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DF_Derecha</span><span class="p">[</span><span class="n">DF_Derecha</span><span class="p">[</span><span class="s1">&#39;totmou&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3180</th>
      <td>1031705</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.000000</td>
      <td>U</td>
      <td>NEW YORK CITY</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>4425</th>
      <td>1043846</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>U</td>
      <td>ATLANTIC SOUTH</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>4561</th>
      <td>1045239</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>U</td>
      <td>DC-MARYLAND-VIRGINIA</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>4684</th>
      <td>1046584</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>U</td>
      <td>GREAT LAKES</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>6926</th>
      <td>1069232</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.666667</td>
      <td>U</td>
      <td>ATLANTIC SOUTH</td>
      <td>N</td>
    </tr>
    <tr>
      <th>7672</th>
      <td>1076695</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NORTH FLORIDA</td>
      <td>N</td>
    </tr>
    <tr>
      <th>8238</th>
      <td>1082423</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.333333</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>8881</th>
      <td>1088967</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.666667</td>
      <td>U</td>
      <td>CHICAGO</td>
      <td>N</td>
    </tr>
    <tr>
      <th>8969</th>
      <td>1089806</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.000000</td>
      <td>U</td>
      <td>CHICAGO</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9158</th>
      <td>1091652</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.000000</td>
      <td>U</td>
      <td>NEW YORK CITY</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082433</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1069242</td>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1031715</td>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1089816</td>
      <td>1863.0</td>
      <td>294.26</td>
      <td>Y</td>
      <td>218</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1076705</td>
      <td>4155.0</td>
      <td>433.16</td>
      <td>N</td>
      <td>222</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1091662</td>
      <td>5441.0</td>
      <td>578.80</td>
      <td>Y</td>
      <td>68</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1043856</td>
      <td>7294.0</td>
      <td>1495.18</td>
      <td>Y</td>
      <td>460</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1088977</td>
      <td>4395.0</td>
      <td>668.23</td>
      <td>N</td>
      <td>333</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1045249</td>
      <td>11544.0</td>
      <td>1012.64</td>
      <td>Y</td>
      <td>498</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1046594</td>
      <td>3751.0</td>
      <td>1199.89</td>
      <td>Y</td>
      <td>592</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DF_Izq</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">agr_df</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">)</span>
<span class="n">DF_Izq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082433</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1069242</td>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1031715</td>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1089816</td>
      <td>1863.0</td>
      <td>294.26</td>
      <td>Y</td>
      <td>218</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1076705</td>
      <td>4155.0</td>
      <td>433.16</td>
      <td>N</td>
      <td>222</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>1027614</td>
      <td>2570.0</td>
      <td>484.31</td>
      <td>Y</td>
      <td>611</td>
      <td>0.666667</td>
      <td>U</td>
      <td>CHICAGO</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>1098422</td>
      <td>2105.0</td>
      <td>583.36</td>
      <td>Y</td>
      <td>1243</td>
      <td>0.000000</td>
      <td>U</td>
      <td>SOUTHWEST</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>1096497</td>
      <td>3690.0</td>
      <td>294.29</td>
      <td>Y</td>
      <td>212</td>
      <td>0.666667</td>
      <td>Y</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>1087248</td>
      <td>3333.0</td>
      <td>233.08</td>
      <td>Y</td>
      <td>290</td>
      <td>0.000000</td>
      <td>U</td>
      <td>CALIFORNIA NORTH</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>1099003</td>
      <td>5025.0</td>
      <td>1436.49</td>
      <td>Y</td>
      <td>1029</td>
      <td>0.333333</td>
      <td>U</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DF_Izq</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DF_Full</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">agr_df</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">)</span>
<span class="n">DF_Full</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082433</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1069242</td>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1031715</td>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1089816</td>
      <td>1863.0</td>
      <td>294.26</td>
      <td>Y</td>
      <td>218.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1076705</td>
      <td>4155.0</td>
      <td>433.16</td>
      <td>N</td>
      <td>222.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10005</th>
      <td>1076695</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NORTH FLORIDA</td>
      <td>N</td>
    </tr>
    <tr>
      <th>10006</th>
      <td>1082423</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.333333</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>10007</th>
      <td>1088967</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.666667</td>
      <td>U</td>
      <td>CHICAGO</td>
      <td>N</td>
    </tr>
    <tr>
      <th>10008</th>
      <td>1089806</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.000000</td>
      <td>U</td>
      <td>CHICAGO</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>10009</th>
      <td>1091652</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.000000</td>
      <td>U</td>
      <td>NEW YORK CITY</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
<p>10010 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DF_Bien</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">agr_df</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">)</span>
<span class="n">DF_Bien</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1076771</td>
      <td>288.0</td>
      <td>374.98</td>
      <td>Y</td>
      <td>284</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1057800</td>
      <td>2030.0</td>
      <td>1026.31</td>
      <td>Y</td>
      <td>439</td>
      <td>0.000000</td>
      <td>Y</td>
      <td>NORTHWEST-ROCKY MOUNTAIN</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1083737</td>
      <td>1928.0</td>
      <td>396.78</td>
      <td>Y</td>
      <td>261</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1008539</td>
      <td>4078.0</td>
      <td>1257.05</td>
      <td>Y</td>
      <td>1019</td>
      <td>0.000000</td>
      <td>N</td>
      <td>ATLANTIC SOUTH</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1056697</td>
      <td>4874.0</td>
      <td>246.77</td>
      <td>Y</td>
      <td>507</td>
      <td>0.000000</td>
      <td>U</td>
      <td>MIDWEST</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9982</th>
      <td>1027614</td>
      <td>2570.0</td>
      <td>484.31</td>
      <td>Y</td>
      <td>611</td>
      <td>0.666667</td>
      <td>U</td>
      <td>CHICAGO</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9983</th>
      <td>1098422</td>
      <td>2105.0</td>
      <td>583.36</td>
      <td>Y</td>
      <td>1243</td>
      <td>0.000000</td>
      <td>U</td>
      <td>SOUTHWEST</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9984</th>
      <td>1096497</td>
      <td>3690.0</td>
      <td>294.29</td>
      <td>Y</td>
      <td>212</td>
      <td>0.666667</td>
      <td>Y</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9985</th>
      <td>1087248</td>
      <td>3333.0</td>
      <td>233.08</td>
      <td>Y</td>
      <td>290</td>
      <td>0.000000</td>
      <td>U</td>
      <td>CALIFORNIA NORTH</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9986</th>
      <td>1099003</td>
      <td>5025.0</td>
      <td>1436.49</td>
      <td>Y</td>
      <td>1029</td>
      <td>0.333333</td>
      <td>U</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
<p>9987 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">=</span><span class="n">df2</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">agr_df</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;creditcd&#39;</span><span class="p">,</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">],</span><span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;creditcd&#39;</span><span class="p">,</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">])</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082423</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
      <td>14.333333</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1069232</td>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83</td>
      <td>3.666667</td>
      <td>U</td>
      <td>ATLANTIC SOUTH</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1031705</td>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675</td>
      <td>3.000000</td>
      <td>U</td>
      <td>NEW YORK CITY</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1089806</td>
      <td>1863.0</td>
      <td>294.26</td>
      <td>Y</td>
      <td>218</td>
      <td>11.000000</td>
      <td>U</td>
      <td>CHICAGO</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1076695</td>
      <td>4155.0</td>
      <td>433.16</td>
      <td>N</td>
      <td>222</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NORTH FLORIDA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>1027614</td>
      <td>2570.0</td>
      <td>484.31</td>
      <td>Y</td>
      <td>611</td>
      <td>0.666667</td>
      <td>U</td>
      <td>CHICAGO</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>1098422</td>
      <td>2105.0</td>
      <td>583.36</td>
      <td>Y</td>
      <td>1243</td>
      <td>0.000000</td>
      <td>U</td>
      <td>SOUTHWEST</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>1096497</td>
      <td>3690.0</td>
      <td>294.29</td>
      <td>Y</td>
      <td>212</td>
      <td>0.666667</td>
      <td>Y</td>
      <td>NEW ENGLAND</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>1087248</td>
      <td>3333.0</td>
      <td>233.08</td>
      <td>Y</td>
      <td>290</td>
      <td>0.000000</td>
      <td>U</td>
      <td>CALIFORNIA NORTH</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>1099003</td>
      <td>5025.0</td>
      <td>1436.49</td>
      <td>Y</td>
      <td>1029</td>
      <td>0.333333</td>
      <td>U</td>
      <td>LOS ANGELES</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">=</span><span class="n">df2</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">agr_df</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
<span class="n">df3</span>
<span class="n">df3</span><span class="p">[</span><span class="n">df3</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">df3</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;AREA.csv&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Bases/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df3</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]]</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082423</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
      <td>14.333333</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1069232</td>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83</td>
      <td>3.666667</td>
      <td>U</td>
      <td>ATLANTIC SOUTH</td>
      <td>N</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1031705</td>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675</td>
      <td>3.000000</td>
      <td>U</td>
      <td>NEW YORK CITY</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1089806</td>
      <td>1863.0</td>
      <td>294.26</td>
      <td>Y</td>
      <td>218</td>
      <td>11.000000</td>
      <td>U</td>
      <td>CHICAGO</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1076695</td>
      <td>4155.0</td>
      <td>433.16</td>
      <td>N</td>
      <td>222</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NORTH FLORIDA</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9992</th>
      <td>1027614</td>
      <td>2570.0</td>
      <td>484.31</td>
      <td>Y</td>
      <td>611</td>
      <td>0.666667</td>
      <td>U</td>
      <td>CHICAGO</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9993</th>
      <td>1098422</td>
      <td>2105.0</td>
      <td>583.36</td>
      <td>Y</td>
      <td>1243</td>
      <td>0.000000</td>
      <td>U</td>
      <td>SOUTHWEST</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9994</th>
      <td>1096497</td>
      <td>3690.0</td>
      <td>294.29</td>
      <td>Y</td>
      <td>212</td>
      <td>0.666667</td>
      <td>Y</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>1087248</td>
      <td>3333.0</td>
      <td>233.08</td>
      <td>Y</td>
      <td>290</td>
      <td>0.000000</td>
      <td>U</td>
      <td>CALIFORNIA NORTH</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>1099003</td>
      <td>5025.0</td>
      <td>1436.49</td>
      <td>Y</td>
      <td>1029</td>
      <td>0.333333</td>
      <td>U</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
<p>9997 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="ejercicio-2">
<h3>Ejercicio 2<a class="headerlink" href="#ejercicio-2" title="Link to this heading">#</a></h3>
<p>¿Cuáles son los 3 registros que no se incluyen en df3 ?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DF_Full</span><span class="p">[</span><span class="n">DF_Full</span><span class="p">[</span><span class="s1">&#39;totmou&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10000</th>
      <td>1031705</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.000000</td>
      <td>U</td>
      <td>NEW YORK CITY</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>10001</th>
      <td>1043846</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>U</td>
      <td>ATLANTIC SOUTH</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>10002</th>
      <td>1045239</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>U</td>
      <td>DC-MARYLAND-VIRGINIA</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>10003</th>
      <td>1046584</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>U</td>
      <td>GREAT LAKES</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>10004</th>
      <td>1069232</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.666667</td>
      <td>U</td>
      <td>ATLANTIC SOUTH</td>
      <td>N</td>
    </tr>
    <tr>
      <th>10005</th>
      <td>1076695</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NORTH FLORIDA</td>
      <td>N</td>
    </tr>
    <tr>
      <th>10006</th>
      <td>1082423</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.333333</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>10007</th>
      <td>1088967</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.666667</td>
      <td>U</td>
      <td>CHICAGO</td>
      <td>N</td>
    </tr>
    <tr>
      <th>10008</th>
      <td>1089806</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.000000</td>
      <td>U</td>
      <td>CHICAGO</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>10009</th>
      <td>1091652</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.000000</td>
      <td>U</td>
      <td>NEW YORK CITY</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DF_Full</span><span class="p">[</span><span class="n">DF_Full</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082433</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1069242</td>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1031715</td>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1089816</td>
      <td>1863.0</td>
      <td>294.26</td>
      <td>Y</td>
      <td>218.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1076705</td>
      <td>4155.0</td>
      <td>433.16</td>
      <td>N</td>
      <td>222.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1091662</td>
      <td>5441.0</td>
      <td>578.80</td>
      <td>Y</td>
      <td>68.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1043856</td>
      <td>7294.0</td>
      <td>1495.18</td>
      <td>Y</td>
      <td>460.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1088977</td>
      <td>4395.0</td>
      <td>668.23</td>
      <td>N</td>
      <td>333.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1045249</td>
      <td>11544.0</td>
      <td>1012.64</td>
      <td>Y</td>
      <td>498.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1046594</td>
      <td>3751.0</td>
      <td>1199.89</td>
      <td>Y</td>
      <td>592.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3381</th>
      <td>1050270</td>
      <td>1409.0</td>
      <td>407.02</td>
      <td>Y</td>
      <td>102.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4281</th>
      <td>1020629</td>
      <td>15284.0</td>
      <td>2370.62</td>
      <td>N</td>
      <td>445.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7384</th>
      <td>1020451</td>
      <td>3604.0</td>
      <td>662.42</td>
      <td>Y</td>
      <td>675.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si deseamos realizar una filtración sobre algún valor relevante por ejemplo el área podremos revertir el proceso usando el operador <code class="docutils literal notranslate"><span class="pre">==</span></code>  que retorna <code class="docutils literal notranslate"><span class="pre">True</span></code> en el caso que dos objetos tengan el mismo valor</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DF_Bien</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 9987 entries, 0 to 9986
Data columns (total 9 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   Customer_ID    9987 non-null   int64  
 1   totmou         9987 non-null   float64
 2   totrev         9987 non-null   float64
 3   creditcd_x     9987 non-null   object 
 4   eqpdays        9987 non-null   int64  
 5   custcare_Mean  9987 non-null   float64
 6   new_cell       9987 non-null   object 
 7   area           9987 non-null   object 
 8   creditcd_y     9835 non-null   object 
dtypes: float64(3), int64(2), object(4)
memory usage: 702.3+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DF_Bien</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span><span class="n">agr_df</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">)</span>
<span class="n">df3</span><span class="o">=</span><span class="n">DF_Bien</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_england</span><span class="o">=</span><span class="n">df3</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s2">&quot;area&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;NEW ENGLAND AREA&quot;</span><span class="p">]</span>
<span class="n">new_england</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>El comando   <code class="docutils literal notranslate"><span class="pre">df3[&quot;area&quot;]==&quot;NEW</span> <span class="pre">ENGLAND</span> <span class="pre">AREA&quot;</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="p">[</span><span class="s2">&quot;area&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;NEW ENGLAND&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        True
1       False
2       False
3       False
4       False
        ...  
9992    False
9993    False
9994     True
9995    False
9996    False
Name: area, Length: 9997, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>devuelve una serie boleana  con el mismo número de filas de la base<code class="docutils literal notranslate"><span class="pre">df3</span></code>, donde cada valor es <code class="docutils literal notranslate"><span class="pre">True</span></code> o <code class="docutils literal notranslate"><span class="pre">False</span></code> dependiendo si el valor de <code class="docutils literal notranslate"><span class="pre">area</span></code> de un registro  toma el valor de “NEW ENGLAND AREA”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s2">&quot;area&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;NEW ENGLAND&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082423</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
      <td>14.333333</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1076771</td>
      <td>288.0</td>
      <td>374.98</td>
      <td>Y</td>
      <td>284</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1083737</td>
      <td>1928.0</td>
      <td>396.78</td>
      <td>Y</td>
      <td>261</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1078557</td>
      <td>2781.0</td>
      <td>590.26</td>
      <td>Y</td>
      <td>276</td>
      <td>0.000000</td>
      <td>N</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1018015</td>
      <td>24069.0</td>
      <td>2129.74</td>
      <td>Y</td>
      <td>199</td>
      <td>2.000000</td>
      <td>N</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9898</th>
      <td>1059454</td>
      <td>942.0</td>
      <td>625.98</td>
      <td>Y</td>
      <td>323</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9900</th>
      <td>1036973</td>
      <td>2538.0</td>
      <td>981.41</td>
      <td>Y</td>
      <td>688</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9959</th>
      <td>1073829</td>
      <td>2812.0</td>
      <td>454.64</td>
      <td>Y</td>
      <td>342</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9990</th>
      <td>1083458</td>
      <td>10628.0</td>
      <td>965.57</td>
      <td>Y</td>
      <td>262</td>
      <td>6.666667</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9994</th>
      <td>1096497</td>
      <td>3690.0</td>
      <td>294.29</td>
      <td>Y</td>
      <td>212</td>
      <td>0.666667</td>
      <td>Y</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
<p>525 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="agrupacion-por-area-geografica">
<h3>Agrupación por área geográfica<a class="headerlink" href="#agrupacion-por-area-geografica" title="Link to this heading">#</a></h3>
<p>En el Analisis de la información se suelen usar funciones de resumen, las cuales plantean el agrupamiento de ciertas características por categorías. Para más información consultar <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html">gropby()</a>.</p>
<p>Para nuestro desarrollo es de interés el revisar si el comportamiento de las variables se mantiene en cada una de las áreas geográficas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;CALIFORNIA NORTH&#39;</span><span class="p">][</span><span class="s1">&#39;creditcd_x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>creditcd_x
Y    407
N    192
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fun_si</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">Y</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="n">fun_no</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">N</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="n">Agrupacion</span><span class="o">=</span><span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;area&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;Customer_ID&#39;</span><span class="p">:</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;totmou&#39;</span><span class="p">:[</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span><span class="s1">&#39;creditcd_x&#39;</span><span class="p">:[</span><span class="n">fun_si</span><span class="p">,</span><span class="n">fun_no</span><span class="p">]})</span>
<span class="n">Agrupacion</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Número de clientes&#39;</span><span class="p">,</span><span class="s1">&#39;Consumo total de minutos&#39;</span><span class="p">,</span><span class="s1">&#39;Consumo Promedio Minutos&#39;</span><span class="p">,</span><span class="s1">&#39;Con Credito&#39;</span><span class="p">,</span><span class="s1">&#39;Sin Credito&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Agrupacion</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Número de clientes</th>
      <th>Consumo total de minutos</th>
      <th>Consumo Promedio Minutos</th>
      <th>Con Credito</th>
      <th>Sin Credito</th>
    </tr>
    <tr>
      <th>area</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ATLANTIC SOUTH</th>
      <td>592</td>
      <td>4.057882e+06</td>
      <td>6854.530794</td>
      <td>0.643581</td>
      <td>0.356419</td>
    </tr>
    <tr>
      <th>CALIFORNIA NORTH</th>
      <td>599</td>
      <td>4.531287e+06</td>
      <td>7564.752666</td>
      <td>0.679466</td>
      <td>0.320534</td>
    </tr>
    <tr>
      <th>CENTRAL-SOUTH TEXAS</th>
      <td>409</td>
      <td>3.834537e+06</td>
      <td>9375.395933</td>
      <td>0.701711</td>
      <td>0.298289</td>
    </tr>
    <tr>
      <th>CHICAGO</th>
      <td>496</td>
      <td>3.243853e+06</td>
      <td>6540.026626</td>
      <td>0.663306</td>
      <td>0.336694</td>
    </tr>
    <tr>
      <th>DALLAS</th>
      <td>518</td>
      <td>4.791310e+06</td>
      <td>9249.633771</td>
      <td>0.720077</td>
      <td>0.279923</td>
    </tr>
    <tr>
      <th>DC-MARYLAND-VIRGINIA</th>
      <td>640</td>
      <td>4.287264e+06</td>
      <td>6698.850000</td>
      <td>0.682813</td>
      <td>0.317188</td>
    </tr>
    <tr>
      <th>GREAT LAKES</th>
      <td>488</td>
      <td>3.664937e+06</td>
      <td>7510.116803</td>
      <td>0.741803</td>
      <td>0.258197</td>
    </tr>
    <tr>
      <th>HOUSTON</th>
      <td>458</td>
      <td>4.303245e+06</td>
      <td>9395.732285</td>
      <td>0.737991</td>
      <td>0.262009</td>
    </tr>
    <tr>
      <th>LOS ANGELES</th>
      <td>671</td>
      <td>5.055043e+06</td>
      <td>7533.596125</td>
      <td>0.687034</td>
      <td>0.312966</td>
    </tr>
    <tr>
      <th>MIDWEST</th>
      <td>685</td>
      <td>5.153547e+06</td>
      <td>7523.426866</td>
      <td>0.735766</td>
      <td>0.264234</td>
    </tr>
    <tr>
      <th>NEW ENGLAND</th>
      <td>525</td>
      <td>3.499815e+06</td>
      <td>6666.315124</td>
      <td>0.706667</td>
      <td>0.293333</td>
    </tr>
    <tr>
      <th>NEW YORK CITY</th>
      <td>1145</td>
      <td>9.539892e+06</td>
      <td>8331.783604</td>
      <td>0.688210</td>
      <td>0.311790</td>
    </tr>
    <tr>
      <th>NORTH FLORIDA</th>
      <td>442</td>
      <td>2.867480e+06</td>
      <td>6487.511312</td>
      <td>0.690045</td>
      <td>0.309955</td>
    </tr>
    <tr>
      <th>NORTHWEST-ROCKY MOUNTAIN</th>
      <td>429</td>
      <td>3.315077e+06</td>
      <td>7727.451562</td>
      <td>0.655012</td>
      <td>0.344988</td>
    </tr>
    <tr>
      <th>OHIO</th>
      <td>437</td>
      <td>2.927894e+06</td>
      <td>6699.986857</td>
      <td>0.755149</td>
      <td>0.244851</td>
    </tr>
    <tr>
      <th>PHILADELPHIA</th>
      <td>245</td>
      <td>1.728323e+06</td>
      <td>7054.378748</td>
      <td>0.722449</td>
      <td>0.277551</td>
    </tr>
    <tr>
      <th>SOUTH FLORIDA</th>
      <td>366</td>
      <td>3.406319e+06</td>
      <td>9306.883761</td>
      <td>0.702186</td>
      <td>0.297814</td>
    </tr>
    <tr>
      <th>SOUTHWEST</th>
      <td>584</td>
      <td>4.589988e+06</td>
      <td>7859.568516</td>
      <td>0.635274</td>
      <td>0.364726</td>
    </tr>
    <tr>
      <th>TENNESSEE</th>
      <td>268</td>
      <td>2.110056e+06</td>
      <td>7873.344950</td>
      <td>0.697761</td>
      <td>0.302239</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conteo</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">Y</span><span class="p">)</span>

<span class="n">conteo</span><span class="p">(</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;creditcd_x&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6946
</pre></div>
</div>
</div>
</div>
<p>Aquí, el objeto DataFrameGroupBy  contiene un objeto DataFrame para cada grupo (en este caso, un objeto DataFrame para cada símbolo). Específicamente, cada elemento del objeto es una tupla que contiene el identificador de grupo (en este caso el símbolo), y las filas correspondientes del DataFrame que tienen ese símbolo).</p>
<p>La librería <code class="docutils literal notranslate"><span class="pre">pandas</span></code>  permite iterar sobre el objeto groupby() para ver lo que hay dentro:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group_df</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;area&quot;</span><span class="p">])</span> <span class="c1"># Datos del grupo en df3 filtrados por el área</span>
<span class="c1"># Haciendo un bucle a través de los grupos</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">group_df</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">))</span> <span class="c1"># Mostrando el tipo de artículo en df3</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># área</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span> <span class="c1"># DataFrame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;tuple&#39;&gt;
(&#39;ATLANTIC SOUTH&#39;,)
    Customer_ID   totmou   totrev creditcd_x  eqpdays  custcare_Mean new_cell  \
1       1069232  13552.0  1172.25          N       83       3.666667        U   
6       1043846   7294.0  1495.18          Y      460       0.000000        U   
13      1008539   4078.0  1257.05          Y     1019       0.000000        N   
48      1068315   5124.0   652.27          N      377       0.000000        U   
83      1074220   6648.0   590.21          N      295       1.666667        U   

              area creditcd_y  
1   ATLANTIC SOUTH          N  
6   ATLANTIC SOUTH          Y  
13  ATLANTIC SOUTH          Y  
48  ATLANTIC SOUTH          N  
83  ATLANTIC SOUTH          N  
&lt;class &#39;tuple&#39;&gt;
(&#39;CALIFORNIA NORTH&#39;,)
     Customer_ID   totmou   totrev creditcd_x  eqpdays  custcare_Mean  \
29       1064411   6282.0   729.54          Y      357      15.666667   
32       1029380   1834.0   610.87          Y      575       0.000000   
45       1056368  10517.0  1108.00          N      307       0.666667   
78       1046285  18750.0  1485.02          Y      534       2.000000   
118      1010813  19030.0  2275.21          N      198       1.333333   

    new_cell              area creditcd_y  
29         U  CALIFORNIA NORTH          Y  
32         U  CALIFORNIA NORTH          Y  
45         Y  CALIFORNIA NORTH          N  
78         Y  CALIFORNIA NORTH          Y  
118        U  CALIFORNIA NORTH          N  
&lt;class &#39;tuple&#39;&gt;
(&#39;CENTRAL-SOUTH TEXAS&#39;,)
     Customer_ID  totmou   totrev creditcd_x  eqpdays  custcare_Mean new_cell  \
30       1016302  6721.0   926.03          Y      893      13.666667        N   
71       1002366  2892.0  1102.53          Y      219       1.000000        U   
87       1062599  3187.0   590.87          Y       16       0.000000        N   
107      1059746  1312.0   488.51          Y      491       0.000000        U   
113      1016781  1928.0  1051.33          Y      779       0.000000        N   

                    area creditcd_y  
30   CENTRAL-SOUTH TEXAS          Y  
71   CENTRAL-SOUTH TEXAS          Y  
87   CENTRAL-SOUTH TEXAS          Y  
107  CENTRAL-SOUTH TEXAS          Y  
113  CENTRAL-SOUTH TEXAS          Y  
&lt;class &#39;tuple&#39;&gt;
(&#39;CHICAGO&#39;,)
    Customer_ID  totmou   totrev creditcd_x  eqpdays  custcare_Mean new_cell  \
3       1089806  1863.0   294.26          Y      218      11.000000        U   
7       1088967  4395.0   668.23          N      333       0.666667        U   
64      1085074  1636.0   543.83          Y      363       0.000000        U   
66      1053959  5871.0   468.14          Y      254       6.666667        Y   
77      1046932  9213.0  1141.79          N      420       1.000000        U   

       area creditcd_y  
3   CHICAGO          Y  
7   CHICAGO          N  
64  CHICAGO          Y  
66  CHICAGO          Y  
77  CHICAGO          N  
&lt;class &#39;tuple&#39;&gt;
(&#39;DALLAS&#39;,)
     Customer_ID   totmou   totrev creditcd_x  eqpdays  custcare_Mean  \
34       1008208  36302.0  5020.37          Y      257            2.0   
52       1013047   4957.0   826.92          Y      790            0.0   
75       1089778   1320.0   445.91          Y      325            0.0   
89       1007540   3841.0   998.41          Y      931            0.0   
156      1023169   3204.0  1181.96          Y      807            0.0   

    new_cell    area creditcd_y  
34         N  DALLAS          Y  
52         U  DALLAS          Y  
75         U  DALLAS          Y  
89         Y  DALLAS          Y  
156        N  DALLAS          Y  
&lt;class &#39;tuple&#39;&gt;
(&#39;DC-MARYLAND-VIRGINIA&#39;,)
    Customer_ID   totmou   totrev creditcd_x  eqpdays  custcare_Mean new_cell  \
8       1045239  11544.0  1012.64          Y      498       0.000000        U   
19      1016607    284.0   825.15          Y        4       0.000000        Y   
20      1015068   5960.0  1902.45          Y      809       0.000000        N   
56      1076198   4787.0  1173.96          Y      333       2.333333        U   
63      1028649   7533.0  1250.63          Y      641       0.000000        U   

                    area creditcd_y  
8   DC-MARYLAND-VIRGINIA          Y  
19  DC-MARYLAND-VIRGINIA          Y  
20  DC-MARYLAND-VIRGINIA          Y  
56  DC-MARYLAND-VIRGINIA          Y  
63  DC-MARYLAND-VIRGINIA          Y  
&lt;class &#39;tuple&#39;&gt;
(&#39;GREAT LAKES&#39;,)
     Customer_ID   totmou   totrev creditcd_x  eqpdays  custcare_Mean  \
9        1046584   3751.0  1199.89          Y      592       0.000000   
36       1023685  12620.0  1959.49          Y      509       0.000000   
37       1035097   1502.0   690.12          Y      603       0.000000   
114      1011051   5886.0   558.61          Y      151       1.666667   
117      1011205  32828.0  2712.13          N      184       7.000000   

    new_cell         area creditcd_y  
9          U  GREAT LAKES          Y  
36         U  GREAT LAKES          Y  
37         U  GREAT LAKES          Y  
114        Y  GREAT LAKES          Y  
117        N  GREAT LAKES          N  
&lt;class &#39;tuple&#39;&gt;
(&#39;HOUSTON&#39;,)
    Customer_ID    totmou   totrev creditcd_x  eqpdays  custcare_Mean  \
23      1088984  10194.00  1089.04          N      209       6.333333   
31      1013751   6346.00  1453.43          Y      460       0.000000   
42      1001867  21518.05  2769.67          Y      657      11.333333   
61      1007086   2097.00  1421.31          Y      569       0.000000   
97      1049782  26249.00  2254.27          N      144       0.000000   

   new_cell     area creditcd_y  
23        U  HOUSTON          N  
31        U  HOUSTON          Y  
42        Y  HOUSTON          Y  
61        N  HOUSTON          Y  
97        N  HOUSTON          N  
&lt;class &#39;tuple&#39;&gt;
(&#39;LOS ANGELES&#39;,)
    Customer_ID   totmou   totrev creditcd_x  eqpdays  custcare_Mean new_cell  \
16      1020126   4411.0  1252.91          Y      741       0.000000        Y   
27      1040941   9195.0   959.63          N      486       1.000000        Y   
38      1015658  59449.0  3531.09          Y      380       0.000000        U   
60      1088347   4060.0   503.72          Y      340      14.333333        U   
69      1019146   2038.0  1000.84          N      796       0.000000        U   

           area creditcd_y  
16  LOS ANGELES          Y  
27  LOS ANGELES          N  
38  LOS ANGELES          Y  
60  LOS ANGELES          Y  
69  LOS ANGELES          N  
&lt;class &#39;tuple&#39;&gt;
(&#39;MIDWEST&#39;,)
     Customer_ID   totmou   totrev creditcd_x  eqpdays  custcare_Mean  \
14       1056697   4874.0   246.77          Y      507       0.000000   
44       1072218   5684.0   857.65          Y      244       4.000000   
49       1005704  21991.0  2809.08          Y      241       0.000000   
102      1040496   2230.0   588.61          N      543       0.000000   
103      1050396   8190.0  1190.50          N      235       1.666667   

    new_cell     area creditcd_y  
14         U  MIDWEST          Y  
44         U  MIDWEST        NaN  
49         Y  MIDWEST          Y  
102        U  MIDWEST          N  
103        N  MIDWEST          N  
&lt;class &#39;tuple&#39;&gt;
(&#39;NEW ENGLAND&#39;,)
    Customer_ID   totmou   totrev creditcd_x  eqpdays  custcare_Mean new_cell  \
0       1082423   7269.0   906.58          Y      371      14.333333        U   
10      1076771    288.0   374.98          Y      284       0.000000        U   
12      1083737   1928.0   396.78          Y      261       0.000000        U   
17      1078557   2781.0   590.26          Y      276       0.000000        N   
18      1018015  24069.0  2129.74          Y      199       2.000000        N   

           area creditcd_y  
0   NEW ENGLAND          Y  
10  NEW ENGLAND          Y  
12  NEW ENGLAND          Y  
17  NEW ENGLAND          Y  
18  NEW ENGLAND          Y  
&lt;class &#39;tuple&#39;&gt;
(&#39;NEW YORK CITY&#39;,)
    Customer_ID  totmou  totrev creditcd_x  eqpdays  custcare_Mean new_cell  \
2       1031705  4152.0  577.39          Y      675       3.000000        U   
5       1091652  5441.0  578.80          Y       68       7.000000        U   
21      1013855  1330.0  898.34          Y      877       0.333333        Y   
40      1055064  2066.0  499.82          N      168      11.666667        Y   
43      1062755  1438.0  445.47          Y      304       0.000000        U   

             area creditcd_y  
2   NEW YORK CITY          Y  
5   NEW YORK CITY          Y  
21  NEW YORK CITY          Y  
40  NEW YORK CITY          N  
43  NEW YORK CITY          Y  
&lt;class &#39;tuple&#39;&gt;
(&#39;NORTH FLORIDA&#39;,)
     Customer_ID  totmou   totrev creditcd_x  eqpdays  custcare_Mean new_cell  \
4        1076695  4155.0   433.16          N      222       0.000000        U   
25       1045505  5699.0  1052.28          Y      109       0.000000        U   
76       1019639  2863.0   809.41          Y      618       1.333333        U   
108      1011394  2242.0  1494.23          Y      940       0.000000        N   
151      1063735  1973.0   543.95          N      406       0.000000        U   

              area creditcd_y  
4    NORTH FLORIDA          N  
25   NORTH FLORIDA          Y  
76   NORTH FLORIDA          Y  
108  NORTH FLORIDA          Y  
151  NORTH FLORIDA          N  
&lt;class &#39;tuple&#39;&gt;
(&#39;NORTHWEST-ROCKY MOUNTAIN&#39;,)
    Customer_ID  totmou   totrev creditcd_x  eqpdays  custcare_Mean new_cell  \
11      1057800  2030.0  1026.31          Y      439       0.000000        Y   
26      1021478  3706.0   734.30          Y      255       0.000000        U   
33      1091059  9703.0   952.30          N      135       0.000000        U   
35      1091061  1989.0   388.85          N      206       0.000000        U   
51      1068378  3981.0   643.93          Y      331       0.666667        U   

                        area creditcd_y  
11  NORTHWEST-ROCKY MOUNTAIN          Y  
26  NORTHWEST-ROCKY MOUNTAIN          Y  
33  NORTHWEST-ROCKY MOUNTAIN          N  
35  NORTHWEST-ROCKY MOUNTAIN          N  
51  NORTHWEST-ROCKY MOUNTAIN          Y  
&lt;class &#39;tuple&#39;&gt;
(&#39;OHIO&#39;,)
    Customer_ID  totmou   totrev creditcd_x  eqpdays  custcare_Mean new_cell  \
53      1011089  4120.0  1186.64          Y      902       0.000000        N   
57      1056196  1737.0   522.76          Y      403       0.333333        U   
86      1071184  3456.0   514.72          Y       18       0.000000        U   
94      1090228  1566.0   492.35          Y      321       0.000000        U   
96      1004669  4707.0  1692.76          Y      345       0.000000        N   

    area creditcd_y  
53  OHIO          Y  
57  OHIO          Y  
86  OHIO          Y  
94  OHIO          Y  
96  OHIO          Y  
&lt;class &#39;tuple&#39;&gt;
(&#39;PHILADELPHIA&#39;,)
     Customer_ID   totmou   totrev creditcd_x  eqpdays  custcare_Mean  \
46       1032592   2842.0   606.76          Y      564       0.000000   
182      1024580  36563.0  2053.30          Y       81       2.333333   
228      1044265    331.0   217.04          N      507       0.000000   
242      1075560   9608.0   876.60          N        8      16.000000   
255      1026798   5738.0  1094.67          Y      573       4.333333   

    new_cell          area creditcd_y  
46         U  PHILADELPHIA          Y  
182        Y  PHILADELPHIA          Y  
228        U  PHILADELPHIA          N  
242        U  PHILADELPHIA          N  
255        N  PHILADELPHIA          Y  
&lt;class &#39;tuple&#39;&gt;
(&#39;SOUTH FLORIDA&#39;,)
     Customer_ID   totmou   totrev creditcd_x  eqpdays  custcare_Mean  \
73       1070208   3275.0   324.41          Y      318       0.000000   
84       1051859   9579.0  1261.47          Y      194       1.000000   
109      1035282  14566.0  1579.38          N       84       2.333333   
125      1025479   2254.0   439.67          Y      608       0.000000   
160      1023124  21199.0  1927.83          Y      451       0.000000   

    new_cell           area creditcd_y  
73         U  SOUTH FLORIDA          Y  
84         U  SOUTH FLORIDA          Y  
109        N  SOUTH FLORIDA          N  
125        U  SOUTH FLORIDA          Y  
160        U  SOUTH FLORIDA          Y  
&lt;class &#39;tuple&#39;&gt;
(&#39;SOUTHWEST&#39;,)
    Customer_ID   totmou   totrev creditcd_x  eqpdays  custcare_Mean new_cell  \
15      1097730    810.0   240.94          N      131       0.000000        U   
22      1044329  12625.0   992.67          Y      552       0.333333        U   
24      1029191   9223.0  1452.24          N      745       0.000000        N   
39      1068005  11271.0   671.80          N      440       0.000000        Y   
41      1091273   3385.0   428.99          N      311       0.666667        U   

         area creditcd_y  
15  SOUTHWEST          N  
22  SOUTHWEST          Y  
24  SOUTHWEST          N  
39  SOUTHWEST          N  
41  SOUTHWEST          N  
&lt;class &#39;tuple&#39;&gt;
(&#39;TENNESSEE&#39;,)
     Customer_ID   totmou   totrev creditcd_x  eqpdays  custcare_Mean  \
50       1047767   2524.0   196.84          N      580            0.0   
74       1019471  14502.0  1776.55          N      748            5.0   
161      1060278   2820.0   519.21          Y      488            3.0   
223      1085161   2821.0   483.02          N      362            0.0   
266      1046324   2529.0  1391.70          Y      426            0.0   

    new_cell       area creditcd_y  
50         U  TENNESSEE          N  
74         N  TENNESSEE          N  
161        Y  TENNESSEE          Y  
223        U  TENNESSEE          N  
266        U  TENNESSEE          Y  
</pre></div>
</div>
</div>
</div>
<p>Usando el método  <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> con el método <code class="docutils literal notranslate"><span class="pre">describe()</span></code> y apliquémoslo a cada símbolo para
analizar la distribución de las características la variable —-.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group_df</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;area&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">group_df</span><span class="p">[</span><span class="s1">&#39;totmou&#39;</span><span class="p">,</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>area
ATLANTIC SOUTH              6854.530794
CALIFORNIA NORTH            7564.752666
CENTRAL-SOUTH TEXAS         9375.395933
CHICAGO                     6540.026626
DALLAS                      9249.633771
DC-MARYLAND-VIRGINIA        6698.850000
GREAT LAKES                 7510.116803
HOUSTON                     9395.732285
LOS ANGELES                 7533.596125
MIDWEST                     7523.426866
NEW ENGLAND                 6666.315124
NEW YORK CITY               8331.783604
NORTH FLORIDA               6487.511312
NORTHWEST-ROCKY MOUNTAIN    7727.451562
OHIO                        6699.986857
PHILADELPHIA                7054.378748
SOUTH FLORIDA               9306.883761
SOUTHWEST                   7859.568516
TENNESSEE                   7873.344950
Name: (totmou, mean), dtype: float64
</pre></div>
</div>
</div>
</div>
<p>En <code class="docutils literal notranslate"><span class="pre">pandas</span></code>tenemos una manera más sencilla de mostrar estos resultados</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="p">[[</span><span class="s2">&quot;area&quot;</span><span class="p">,</span><span class="s2">&quot;totrev&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;area&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">totrev</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>area</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ATLANTIC SOUTH</th>
      <td>592.0</td>
      <td>903.497399</td>
      <td>697.197572</td>
      <td>106.95</td>
      <td>464.9875</td>
      <td>718.370</td>
      <td>1135.3050</td>
      <td>8171.47</td>
    </tr>
    <tr>
      <th>CALIFORNIA NORTH</th>
      <td>599.0</td>
      <td>1136.348013</td>
      <td>922.069148</td>
      <td>105.14</td>
      <td>535.9900</td>
      <td>892.340</td>
      <td>1396.4550</td>
      <td>7511.11</td>
    </tr>
    <tr>
      <th>CENTRAL-SOUTH TEXAS</th>
      <td>409.0</td>
      <td>1174.366577</td>
      <td>920.804942</td>
      <td>48.53</td>
      <td>594.3300</td>
      <td>895.090</td>
      <td>1374.5800</td>
      <td>5848.39</td>
    </tr>
    <tr>
      <th>CHICAGO</th>
      <td>496.0</td>
      <td>892.133206</td>
      <td>669.068444</td>
      <td>59.90</td>
      <td>474.0675</td>
      <td>718.855</td>
      <td>1086.9250</td>
      <td>5710.44</td>
    </tr>
    <tr>
      <th>DALLAS</th>
      <td>518.0</td>
      <td>1258.508784</td>
      <td>1267.499852</td>
      <td>84.59</td>
      <td>581.6975</td>
      <td>965.650</td>
      <td>1484.8500</td>
      <td>13149.85</td>
    </tr>
    <tr>
      <th>DC-MARYLAND-VIRGINIA</th>
      <td>640.0</td>
      <td>941.692188</td>
      <td>634.132033</td>
      <td>86.78</td>
      <td>525.7200</td>
      <td>787.360</td>
      <td>1191.5525</td>
      <td>5029.68</td>
    </tr>
    <tr>
      <th>GREAT LAKES</th>
      <td>488.0</td>
      <td>987.714324</td>
      <td>733.521417</td>
      <td>126.56</td>
      <td>503.7325</td>
      <td>767.960</td>
      <td>1211.8900</td>
      <td>5624.71</td>
    </tr>
    <tr>
      <th>HOUSTON</th>
      <td>458.0</td>
      <td>1127.294127</td>
      <td>999.987571</td>
      <td>92.38</td>
      <td>530.6400</td>
      <td>892.180</td>
      <td>1443.1400</td>
      <td>8719.53</td>
    </tr>
    <tr>
      <th>LOS ANGELES</th>
      <td>671.0</td>
      <td>1031.714382</td>
      <td>738.616227</td>
      <td>96.74</td>
      <td>554.2650</td>
      <td>836.770</td>
      <td>1271.6150</td>
      <td>6120.84</td>
    </tr>
    <tr>
      <th>MIDWEST</th>
      <td>685.0</td>
      <td>1095.678701</td>
      <td>945.251868</td>
      <td>90.42</td>
      <td>553.0600</td>
      <td>854.350</td>
      <td>1338.6900</td>
      <td>13426.60</td>
    </tr>
    <tr>
      <th>NEW ENGLAND</th>
      <td>525.0</td>
      <td>941.766038</td>
      <td>705.572889</td>
      <td>118.51</td>
      <td>497.5700</td>
      <td>747.130</td>
      <td>1185.8000</td>
      <td>6939.19</td>
    </tr>
    <tr>
      <th>NEW YORK CITY</th>
      <td>1145.0</td>
      <td>1076.263546</td>
      <td>869.372842</td>
      <td>74.01</td>
      <td>562.3400</td>
      <td>870.310</td>
      <td>1297.9700</td>
      <td>10590.01</td>
    </tr>
    <tr>
      <th>NORTH FLORIDA</th>
      <td>442.0</td>
      <td>895.489457</td>
      <td>642.729028</td>
      <td>37.39</td>
      <td>481.5225</td>
      <td>758.190</td>
      <td>1134.1950</td>
      <td>6009.01</td>
    </tr>
    <tr>
      <th>NORTHWEST-ROCKY MOUNTAIN</th>
      <td>429.0</td>
      <td>1083.179091</td>
      <td>977.857935</td>
      <td>67.80</td>
      <td>524.3700</td>
      <td>805.020</td>
      <td>1293.2200</td>
      <td>7419.73</td>
    </tr>
    <tr>
      <th>OHIO</th>
      <td>437.0</td>
      <td>1006.616499</td>
      <td>785.713223</td>
      <td>107.12</td>
      <td>512.0700</td>
      <td>781.040</td>
      <td>1230.5600</td>
      <td>8007.95</td>
    </tr>
    <tr>
      <th>PHILADELPHIA</th>
      <td>245.0</td>
      <td>998.303592</td>
      <td>722.348164</td>
      <td>133.63</td>
      <td>558.7100</td>
      <td>849.340</td>
      <td>1154.6100</td>
      <td>4819.91</td>
    </tr>
    <tr>
      <th>SOUTH FLORIDA</th>
      <td>366.0</td>
      <td>1167.546257</td>
      <td>891.952255</td>
      <td>118.62</td>
      <td>582.0225</td>
      <td>914.600</td>
      <td>1451.2550</td>
      <td>6954.07</td>
    </tr>
    <tr>
      <th>SOUTHWEST</th>
      <td>584.0</td>
      <td>1036.548630</td>
      <td>914.475459</td>
      <td>11.10</td>
      <td>508.3275</td>
      <td>802.025</td>
      <td>1187.3275</td>
      <td>8772.57</td>
    </tr>
    <tr>
      <th>TENNESSEE</th>
      <td>268.0</td>
      <td>1042.700597</td>
      <td>886.731980</td>
      <td>102.03</td>
      <td>486.6800</td>
      <td>832.400</td>
      <td>1282.6150</td>
      <td>6751.70</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Estos resultados son iguales a los realizados con el ciclo <code class="docutils literal notranslate"><span class="pre">for</span></code>. Los objetos de tipo <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> permiten una rápida salida de generación de estadísticas para grupos de interés.</p>
</section>
<section id="ejercicio-3">
<h3>Ejercicio 3<a class="headerlink" href="#ejercicio-3" title="Link to this heading">#</a></h3>
<p>Realice una agrupación por la variable creditcd_x y encuentre el valor de la desviación estándar</p>
</section>
<section id="etiquetando-valores-de-total-de-ingresos-en-categorias">
<h3>Etiquetando valores de total de ingresos en categorías<a class="headerlink" href="#etiquetando-valores-de-total-de-ingresos-en-categorias" title="Link to this heading">#</a></h3>
<p>Revisamos el comportamiento de <code class="docutils literal notranslate"><span class="pre">totrev</span></code> y encontramos una gran variabilidad, en ocasiones la agrupación de variables cuantitativas en diferentes categorías nos ayuda a tener una mejor visión del conjunto de datos.</p>
<p>Crearemos una nueva variable <code class="docutils literal notranslate"><span class="pre">Nivel_totrev</span></code>  que catalogue a la variable total de ingresos <code class="docutils literal notranslate"><span class="pre">totrev</span></code> en 2 posibles niveles, alto en el caso que <code class="docutils literal notranslate"><span class="pre">totrev</span></code>  sea mayor al cuantil 50 y baja en otro caso. cada valor de percentil debe ser calculado por cada <code class="docutils literal notranslate"><span class="pre">area</span></code> para asegurar que el +area geografíca sea evaluada adicionalmente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pencentiles50</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;area&quot;</span><span class="p">)[</span><span class="s2">&quot;totrev&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># percentil 50</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pencentiles50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>area
ATLANTIC SOUTH              718.370
CALIFORNIA NORTH            892.340
CENTRAL-SOUTH TEXAS         895.090
CHICAGO                     718.855
DALLAS                      965.650
DC-MARYLAND-VIRGINIA        787.360
GREAT LAKES                 767.960
HOUSTON                     892.180
LOS ANGELES                 836.770
MIDWEST                     854.350
NEW ENGLAND                 747.130
NEW YORK CITY               870.310
NORTH FLORIDA               758.190
NORTHWEST-ROCKY MOUNTAIN    805.020
OHIO                        781.040
PHILADELPHIA                849.340
SOUTH FLORIDA               914.600
SOUTHWEST                   802.025
TENNESSEE                   832.400
Name: totrev, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Como nos gustaría etiquetar los ingreos en alto y bajopara  cada área geográfica, haremos uso del método
<code class="docutils literal notranslate"><span class="pre">np.where()</span></code> en la biblioteca numpy. Este método toma una entrada y comprueba una condición lógica: si la
condición es verdadera, devolverá su segundo argumento, mientras que si la condición es falsa, devolverá su
tercer argumento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loop a través de los símbolos</span>
<span class="n">areas</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;AREA.csv&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Bases/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df3</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span><span class="c1"># registro de las áreas</span>
<span class="n">lista_df</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># ciclo sobre todos los símbolos</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">areas</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Etiqueta por área: &quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">temp_df</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s2">&quot;area&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">umbral_punto</span> <span class="o">=</span> <span class="n">pencentiles50</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">temp_df</span><span class="p">[</span><span class="s2">&quot;Nivel_totrev&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s2">&quot;totrev&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">umbral_punto</span><span class="p">,</span> <span class="s2">&quot;Bajo&quot;</span><span class="p">,</span> <span class="s2">&quot;Alto&quot;</span><span class="p">)</span> 
    <span class="n">lista_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_df</span><span class="p">)</span>
<span class="n">df_con_etiquetas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">lista_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Etiqueta por área: NEW ENGLAND
Etiqueta por área: ATLANTIC SOUTH
Etiqueta por área: NEW YORK CITY
Etiqueta por área: CHICAGO
Etiqueta por área: NORTH FLORIDA
Etiqueta por área: DC-MARYLAND-VIRGINIA
Etiqueta por área: GREAT LAKES
Etiqueta por área: NORTHWEST-ROCKY MOUNTAIN
Etiqueta por área: MIDWEST
Etiqueta por área: SOUTHWEST
Etiqueta por área: LOS ANGELES
Etiqueta por área: HOUSTON
Etiqueta por área: CALIFORNIA NORTH
Etiqueta por área: CENTRAL-SOUTH TEXAS
Etiqueta por área: DALLAS
Etiqueta por área: PHILADELPHIA
Etiqueta por área: TENNESSEE
Etiqueta por área: OHIO
Etiqueta por área: SOUTH FLORIDA
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_con_etiquetas</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
      <th>Nivel_totrev</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082423</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
      <td>14.333333</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Alto</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1076771</td>
      <td>288.0</td>
      <td>374.98</td>
      <td>Y</td>
      <td>284</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Bajo</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1083737</td>
      <td>1928.0</td>
      <td>396.78</td>
      <td>Y</td>
      <td>261</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Bajo</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1078557</td>
      <td>2781.0</td>
      <td>590.26</td>
      <td>Y</td>
      <td>276</td>
      <td>0.000000</td>
      <td>N</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Bajo</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1018015</td>
      <td>24069.0</td>
      <td>2129.74</td>
      <td>Y</td>
      <td>199</td>
      <td>2.000000</td>
      <td>N</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Alto</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_con_etiquetas</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
      <th>Nivel_totrev</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082423</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
      <td>14.333333</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Alto</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1076771</td>
      <td>288.0</td>
      <td>374.98</td>
      <td>Y</td>
      <td>284</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Bajo</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1083737</td>
      <td>1928.0</td>
      <td>396.78</td>
      <td>Y</td>
      <td>261</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Bajo</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1078557</td>
      <td>2781.0</td>
      <td>590.26</td>
      <td>Y</td>
      <td>276</td>
      <td>0.000000</td>
      <td>N</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Bajo</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1018015</td>
      <td>24069.0</td>
      <td>2129.74</td>
      <td>Y</td>
      <td>199</td>
      <td>2.000000</td>
      <td>N</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Alto</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ahora podemos hacer una evaluaciónd de como es el comportamiento de los minutos gastados y el nivel de ingresos de los clientes</p>
</section>
<section id="existe-relacion-alguna-entre-el-total-de-minutos-usados-con-la-compania-y-el-ingreso-total-de-los-clientes">
<h3>¿Existe relación alguna entre el total de minutos usados con la compañía y el ingreso total de los clientes?<a class="headerlink" href="#existe-relacion-alguna-entre-el-total-de-minutos-usados-con-la-compania-y-el-ingreso-total-de-los-clientes" title="Link to this heading">#</a></h3>
<p>Para explorar la relación entre el nivel de total de ingresos y el número promedio de llamadas, agrupemos por
Nivel_totrev y miremos ingreso total promedio por cada +area geográfica.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_con_etiquetas</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;area&#39;</span><span class="p">,</span><span class="s1">&#39;Nivel_totrev&#39;</span><span class="p">])[[</span><span class="s1">&#39;totmou&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>totmou</th>
    </tr>
    <tr>
      <th>area</th>
      <th>Nivel_totrev</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">ATLANTIC SOUTH</th>
      <th>Alto</th>
      <td>10287.102128</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3421.959459</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">CALIFORNIA NORTH</th>
      <th>Alto</th>
      <td>11937.216156</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3177.665552</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">CENTRAL-SOUTH TEXAS</th>
      <th>Alto</th>
      <td>14306.189935</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>4420.431373</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">CHICAGO</th>
      <th>Alto</th>
      <td>9733.863737</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3346.189516</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">DALLAS</th>
      <th>Alto</th>
      <td>14388.723140</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>4110.544402</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">DC-MARYLAND-VIRGINIA</th>
      <th>Alto</th>
      <td>9822.787500</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3574.912500</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">GREAT LAKES</th>
      <th>Alto</th>
      <td>11343.180328</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3677.053279</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">HOUSTON</th>
      <th>Alto</th>
      <td>14512.521339</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>4278.943231</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">LOS ANGELES</th>
      <th>Alto</th>
      <td>11593.681548</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3461.391045</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">MIDWEST</th>
      <th>Alto</th>
      <td>11656.333537</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3378.435673</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">NEW ENGLAND</th>
      <th>Alto</th>
      <td>9935.876198</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3384.274809</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">NEW YORK CITY</th>
      <th>Alto</th>
      <td>12424.576312</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>4231.835664</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">NORTH FLORIDA</th>
      <th>Alto</th>
      <td>9556.276018</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3418.746606</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">NORTHWEST-ROCKY MOUNTAIN</th>
      <th>Alto</th>
      <td>12433.277767</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2999.635514</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">OHIO</th>
      <th>Alto</th>
      <td>10047.156423</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3337.463303</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">PHILADELPHIA</th>
      <th>Alto</th>
      <td>10962.949539</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3113.770492</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">SOUTH FLORIDA</th>
      <th>Alto</th>
      <td>14445.641840</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>4168.125683</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">SOUTHWEST</th>
      <th>Alto</th>
      <td>12293.684977</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3425.452055</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">TENNESSEE</th>
      <th>Alto</th>
      <td>12103.077960</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3643.611940</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="ejercicio-4">
<h3>Ejercicio 4<a class="headerlink" href="#ejercicio-4" title="Link to this heading">#</a></h3>
<p>Escriba el código para categorizar  el total de ingresos  baja, media y alta volatilidad, donde:</p>
<p><code class="docutils literal notranslate"> <span class="pre">si</span> <span class="pre">totrev</span> <span class="pre">&gt;</span> <span class="pre">(percentil</span> <span class="pre">75</span> <span class="pre">de</span> <span class="pre">totrev</span> <span class="pre">para</span> <span class="pre">el</span> <span class="pre">área</span> <span class="pre">dada):</span> <span class="pre">Nivel_totrev</span> <span class="pre">=</span> <span class="pre">'Alto'</span> <span class="pre">o</span> <span class="pre">si</span> <span class="pre">VolStat</span> <span class="pre">&gt;</span> <span class="pre">(percentil</span> <span class="pre">25</span> <span class="pre">de</span> <span class="pre">totrev</span> <span class="pre">para</span> <span class="pre">el</span> <span class="pre">área</span> <span class="pre">dada):</span> <span class="pre">Nivel_totrev</span>&#160; <span class="pre">=</span> <span class="pre">'Medio'</span> <span class="pre">de</span> <span class="pre">lo</span> <span class="pre">contrario:</span> <span class="pre">Nivel_totrev</span>&#160; <span class="pre">=</span> <span class="pre">'Bajo'</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pencentiles25</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;area&quot;</span><span class="p">)[</span><span class="s2">&quot;totrev&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span> <span class="c1"># percentil 50</span>
<span class="n">pencentiles75</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;area&quot;</span><span class="p">)[</span><span class="s2">&quot;totrev&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># registro de las áreas</span>
<span class="n">lista_df</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># ciclo sobre todos los símbolos</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">areas</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Etiqueta por área: &quot;</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">temp_df</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s2">&quot;area&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">umbral_punto1</span> <span class="o">=</span> <span class="n">pencentiles25</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">umbral_punto2</span> <span class="o">=</span> <span class="n">pencentiles75</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">lv</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;totrev&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">umbral_punto1</span><span class="p">:</span>
            <span class="n">lv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Bajo&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">umbral_punto2</span><span class="p">:</span>
            <span class="n">lv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Medio&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Alto&#39;</span><span class="p">)</span>
    <span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;Nivel&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">lv</span>
    <span class="n">lista_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_df</span><span class="p">)</span>
<span class="n">df_con_etiquetas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">lista_df</span><span class="p">)</span>
<span class="c1"># realice el ejercicio en este espacio</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Etiqueta por área: NEW ENGLAND
Etiqueta por área: ATLANTIC SOUTH
Etiqueta por área: NEW YORK CITY
Etiqueta por área: CHICAGO
Etiqueta por área: NORTH FLORIDA
Etiqueta por área: DC-MARYLAND-VIRGINIA
Etiqueta por área: GREAT LAKES
Etiqueta por área: NORTHWEST-ROCKY MOUNTAIN
Etiqueta por área: MIDWEST
Etiqueta por área: SOUTHWEST
Etiqueta por área: LOS ANGELES
Etiqueta por área: HOUSTON
Etiqueta por área: CALIFORNIA NORTH
Etiqueta por área: CENTRAL-SOUTH TEXAS
Etiqueta por área: DALLAS
Etiqueta por área: PHILADELPHIA
Etiqueta por área: TENNESSEE
Etiqueta por área: OHIO
Etiqueta por área: SOUTH FLORIDA
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_con_etiquetas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
      <th>Nivel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082423</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
      <td>14.333333</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Medio</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1076771</td>
      <td>288.0</td>
      <td>374.98</td>
      <td>Y</td>
      <td>284</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Bajo</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1083737</td>
      <td>1928.0</td>
      <td>396.78</td>
      <td>Y</td>
      <td>261</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Bajo</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1078557</td>
      <td>2781.0</td>
      <td>590.26</td>
      <td>Y</td>
      <td>276</td>
      <td>0.000000</td>
      <td>N</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Medio</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1018015</td>
      <td>24069.0</td>
      <td>2129.74</td>
      <td>Y</td>
      <td>199</td>
      <td>2.000000</td>
      <td>N</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
      <td>Alto</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9795</th>
      <td>1085316</td>
      <td>7637.0</td>
      <td>744.81</td>
      <td>N</td>
      <td>254</td>
      <td>10.333333</td>
      <td>U</td>
      <td>SOUTH FLORIDA</td>
      <td>N</td>
      <td>Medio</td>
    </tr>
    <tr>
      <th>9838</th>
      <td>1096235</td>
      <td>8731.0</td>
      <td>556.88</td>
      <td>Y</td>
      <td>220</td>
      <td>0.333333</td>
      <td>Y</td>
      <td>SOUTH FLORIDA</td>
      <td>Y</td>
      <td>Bajo</td>
    </tr>
    <tr>
      <th>9866</th>
      <td>1075355</td>
      <td>5891.0</td>
      <td>696.77</td>
      <td>Y</td>
      <td>103</td>
      <td>0.000000</td>
      <td>U</td>
      <td>SOUTH FLORIDA</td>
      <td>Y</td>
      <td>Medio</td>
    </tr>
    <tr>
      <th>9947</th>
      <td>1068658</td>
      <td>2923.0</td>
      <td>871.30</td>
      <td>Y</td>
      <td>329</td>
      <td>0.000000</td>
      <td>U</td>
      <td>SOUTH FLORIDA</td>
      <td>Y</td>
      <td>Medio</td>
    </tr>
    <tr>
      <th>9986</th>
      <td>1007937</td>
      <td>3875.0</td>
      <td>1157.80</td>
      <td>Y</td>
      <td>1093</td>
      <td>0.000000</td>
      <td>Y</td>
      <td>SOUTH FLORIDA</td>
      <td>Y</td>
      <td>Medio</td>
    </tr>
  </tbody>
</table>
<p>9997 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_con_etiquetas</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;area&#39;</span><span class="p">,</span><span class="s1">&#39;Nivel&#39;</span><span class="p">])[[</span><span class="s1">&#39;totmou&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>totmou</th>
    </tr>
    <tr>
      <th>area</th>
      <th>Nivel</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">ATLANTIC SOUTH</th>
      <th>Alto</th>
      <td>13926.143446</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2650.763514</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5420.608108</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">CALIFORNIA NORTH</th>
      <th>Alto</th>
      <td>16923.098622</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2490.000000</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5415.792821</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">CENTRAL-SOUTH TEXAS</th>
      <th>Alto</th>
      <td>20606.785599</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3232.813725</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>6775.936373</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">CHICAGO</th>
      <th>Alto</th>
      <td>13348.808118</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2816.330645</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>4997.483871</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">DALLAS</th>
      <th>Alto</th>
      <td>20564.633026</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2707.415385</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>6844.744186</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">DC-MARYLAND-VIRGINIA</th>
      <th>Alto</th>
      <td>13190.250000</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2578.475000</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5513.337500</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">GREAT LAKES</th>
      <th>Alto</th>
      <td>15643.122951</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2555.688525</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5920.827869</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">HOUSTON</th>
      <th>Alto</th>
      <td>19911.151188</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>3234.834783</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>7199.372807</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">LOS ANGELES</th>
      <th>Alto</th>
      <td>15865.452381</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2600.904762</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5828.940299</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">MIDWEST</th>
      <th>Alto</th>
      <td>16387.194109</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2634.964912</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5509.856774</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">NEW ENGLAND</th>
      <th>Alto</th>
      <td>13696.321515</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2603.923664</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5155.675573</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">NEW YORK CITY</th>
      <th>Alto</th>
      <td>16748.160825</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2986.430070</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>6781.557815</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">NORTH FLORIDA</th>
      <th>Alto</th>
      <td>13237.594595</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2401.306306</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5143.463636</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">NORTHWEST-ROCKY MOUNTAIN</th>
      <th>Alto</th>
      <td>18100.312222</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2463.401869</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5124.574766</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">OHIO</th>
      <th>Alto</th>
      <td>13624.429606</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2323.844037</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5394.073394</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">PHILADELPHIA</th>
      <th>Alto</th>
      <td>14678.319247</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>1965.803279</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5724.204918</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">SOUTH FLORIDA</th>
      <th>Alto</th>
      <td>20244.939746</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2829.706522</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>7051.934066</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">SOUTHWEST</th>
      <th>Alto</th>
      <td>17785.746667</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2368.095890</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5642.215753</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">TENNESSEE</th>
      <th>Alto</th>
      <td>16941.573831</td>
    </tr>
    <tr>
      <th>Bajo</th>
      <td>2788.373134</td>
    </tr>
    <tr>
      <th>Medio</th>
      <td>5881.716418</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="visualizacion-de-total-de-llamadas-y-total-de-ingresos">
<h3>Visualización de total de llamadas y total de ingresos<a class="headerlink" href="#visualizacion-de-total-de-llamadas-y-total-de-ingresos" title="Link to this heading">#</a></h3>
<p>Ya hemos respondido satisfactoriamente a nuestra pregunta original. Sin embargo, no es necesario solamente
analizar los datos en formato tabular. Python contiene una funcionalidad que le permite analizar sus datos
visualmente también.</p>
<p>Usaremos la funcionalidad de pandas sobre la librería estándar de graficación de Python, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>. Vamos
a importar la librería e instruir a Jupyter que muestre los gráficos en línea (es decir, mostrar los gráficos en
la pantalla del cuaderno para que podamos verlos mientras ejecutamos el código):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modules</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modules</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Agrupacion&#39;, &#39;DF_Bien&#39;, &#39;DF_Derecha&#39;, &#39;DF_Full&#39;, &#39;DF_Izq&#39;, &#39;DF_filtrado&#39;, &#39;Data_Frame&#39;, &#39;In&#39;, &#39;Out&#39;, &#39;Serie1&#39;, &#39;_&#39;, &#39;_10&#39;, &#39;_100&#39;, &#39;_101&#39;, &#39;_102&#39;, &#39;_105&#39;, &#39;_106&#39;, &#39;_11&#39;, &#39;_12&#39;, &#39;_13&#39;, &#39;_19&#39;, &#39;_21&#39;, &#39;_22&#39;, &#39;_23&#39;, &#39;_25&#39;, &#39;_26&#39;, &#39;_27&#39;, &#39;_29&#39;, &#39;_3&#39;, &#39;_30&#39;, &#39;_31&#39;, &#39;_32&#39;, &#39;_33&#39;, &#39;_35&#39;, &#39;_36&#39;, &#39;_37&#39;, &#39;_4&#39;, &#39;_41&#39;, &#39;_42&#39;, &#39;_43&#39;, &#39;_44&#39;, &#39;_45&#39;, &#39;_46&#39;, &#39;_48&#39;, &#39;_49&#39;, &#39;_5&#39;, &#39;_50&#39;, &#39;_51&#39;, &#39;_52&#39;, &#39;_53&#39;, &#39;_54&#39;, &#39;_55&#39;, &#39;_56&#39;, &#39;_57&#39;, &#39;_58&#39;, &#39;_59&#39;, &#39;_6&#39;, &#39;_60&#39;, &#39;_61&#39;, &#39;_62&#39;, &#39;_63&#39;, &#39;_65&#39;, &#39;_67&#39;, &#39;_68&#39;, &#39;_69&#39;, &#39;_72&#39;, &#39;_74&#39;, &#39;_75&#39;, &#39;_76&#39;, &#39;_77&#39;, &#39;_78&#39;, &#39;_79&#39;, &#39;_8&#39;, &#39;_80&#39;, &#39;_81&#39;, &#39;_82&#39;, &#39;_83&#39;, &#39;_84&#39;, &#39;_85&#39;, &#39;_88&#39;, &#39;_89&#39;, &#39;_90&#39;, &#39;_91&#39;, &#39;_93&#39;, &#39;_94&#39;, &#39;_96&#39;, &#39;_97&#39;, &#39;__&#39;, &#39;___&#39;, &#39;__builtin__&#39;, &#39;__builtins__&#39;, &#39;__doc__&#39;, &#39;__loader__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;__spec__&#39;, &#39;_dh&#39;, &#39;_exit_code&#39;, &#39;_i&#39;, &#39;_i1&#39;, &#39;_i10&#39;, &#39;_i100&#39;, &#39;_i101&#39;, &#39;_i102&#39;, &#39;_i103&#39;, &#39;_i104&#39;, &#39;_i105&#39;, &#39;_i106&#39;, &#39;_i107&#39;, &#39;_i11&#39;, &#39;_i12&#39;, &#39;_i13&#39;, &#39;_i14&#39;, &#39;_i15&#39;, &#39;_i16&#39;, &#39;_i17&#39;, &#39;_i18&#39;, &#39;_i19&#39;, &#39;_i2&#39;, &#39;_i20&#39;, &#39;_i21&#39;, &#39;_i22&#39;, &#39;_i23&#39;, &#39;_i24&#39;, &#39;_i25&#39;, &#39;_i26&#39;, &#39;_i27&#39;, &#39;_i28&#39;, &#39;_i29&#39;, &#39;_i3&#39;, &#39;_i30&#39;, &#39;_i31&#39;, &#39;_i32&#39;, &#39;_i33&#39;, &#39;_i34&#39;, &#39;_i35&#39;, &#39;_i36&#39;, &#39;_i37&#39;, &#39;_i38&#39;, &#39;_i39&#39;, &#39;_i4&#39;, &#39;_i40&#39;, &#39;_i41&#39;, &#39;_i42&#39;, &#39;_i43&#39;, &#39;_i44&#39;, &#39;_i45&#39;, &#39;_i46&#39;, &#39;_i47&#39;, &#39;_i48&#39;, &#39;_i49&#39;, &#39;_i5&#39;, &#39;_i50&#39;, &#39;_i51&#39;, &#39;_i52&#39;, &#39;_i53&#39;, &#39;_i54&#39;, &#39;_i55&#39;, &#39;_i56&#39;, &#39;_i57&#39;, &#39;_i58&#39;, &#39;_i59&#39;, &#39;_i6&#39;, &#39;_i60&#39;, &#39;_i61&#39;, &#39;_i62&#39;, &#39;_i63&#39;, &#39;_i64&#39;, &#39;_i65&#39;, &#39;_i66&#39;, &#39;_i67&#39;, &#39;_i68&#39;, &#39;_i69&#39;, &#39;_i7&#39;, &#39;_i70&#39;, &#39;_i71&#39;, &#39;_i72&#39;, &#39;_i73&#39;, &#39;_i74&#39;, &#39;_i75&#39;, &#39;_i76&#39;, &#39;_i77&#39;, &#39;_i78&#39;, &#39;_i79&#39;, &#39;_i8&#39;, &#39;_i80&#39;, &#39;_i81&#39;, &#39;_i82&#39;, &#39;_i83&#39;, &#39;_i84&#39;, &#39;_i85&#39;, &#39;_i86&#39;, &#39;_i87&#39;, &#39;_i88&#39;, &#39;_i89&#39;, &#39;_i9&#39;, &#39;_i90&#39;, &#39;_i91&#39;, &#39;_i92&#39;, &#39;_i93&#39;, &#39;_i94&#39;, &#39;_i95&#39;, &#39;_i96&#39;, &#39;_i97&#39;, &#39;_i98&#39;, &#39;_i99&#39;, &#39;_ih&#39;, &#39;_ii&#39;, &#39;_iii&#39;, &#39;_oh&#39;, &#39;agr_df&#39;, &#39;areas&#39;, &#39;conteo&#39;, &#39;df&#39;, &#39;df2&#39;, &#39;df3&#39;, &#39;df_con_etiquetas&#39;, &#39;exit&#39;, &#39;fun_no&#39;, &#39;fun_si&#39;, &#39;get_ipython&#39;, &#39;group_df&#39;, &#39;i&#39;, &#39;item&#39;, &#39;lista_de_df&#39;, &#39;lista_df&#39;, &#39;lv&#39;, &#39;new_england&#39;, &#39;np&#39;, &#39;open&#39;, &#39;os&#39;, &#39;pd&#39;, &#39;pencentiles25&#39;, &#39;pencentiles50&#39;, &#39;pencentiles75&#39;, &#39;perd&#39;, &#39;perdidos&#39;, &#39;plt&#39;, &#39;promedio&#39;, &#39;quit&#39;, &#39;temp_df&#39;, &#39;texto&#39;, &#39;umbral_punto&#39;, &#39;umbral_punto1&#39;, &#39;umbral_punto2&#39;, &#39;warnings&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># Graficar en el cuaderno</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<section id="histograma">
<h4>Histograma<a class="headerlink" href="#histograma" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df3</span><span class="p">[</span><span class="s2">&quot;totrev&quot;</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#237AAF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma de variable totrev&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;totrev&quot;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e11edc451ef753071b96e36ebe3b64e674f3cbafa6d7b1708f681b18bfca118a.png" src="../_images/e11edc451ef753071b96e36ebe3b64e674f3cbafa6d7b1708f681b18bfca118a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">available</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Solarize_Light2&#39;, &#39;_classic_test_patch&#39;, &#39;_mpl-gallery&#39;, &#39;_mpl-gallery-nogrid&#39;, &#39;bmh&#39;, &#39;classic&#39;, &#39;dark_background&#39;, &#39;fast&#39;, &#39;fivethirtyeight&#39;, &#39;ggplot&#39;, &#39;grayscale&#39;, &#39;seaborn-v0_8&#39;, &#39;seaborn-v0_8-bright&#39;, &#39;seaborn-v0_8-colorblind&#39;, &#39;seaborn-v0_8-dark&#39;, &#39;seaborn-v0_8-dark-palette&#39;, &#39;seaborn-v0_8-darkgrid&#39;, &#39;seaborn-v0_8-deep&#39;, &#39;seaborn-v0_8-muted&#39;, &#39;seaborn-v0_8-notebook&#39;, &#39;seaborn-v0_8-paper&#39;, &#39;seaborn-v0_8-pastel&#39;, &#39;seaborn-v0_8-poster&#39;, &#39;seaborn-v0_8-talk&#39;, &#39;seaborn-v0_8-ticks&#39;, &#39;seaborn-v0_8-white&#39;, &#39;seaborn-v0_8-whitegrid&#39;, &#39;tableau-colorblind10&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="boxplot">
<h4>Boxplot<a class="headerlink" href="#boxplot" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">df3</span><span class="p">[</span><span class="s2">&quot;totrev&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot de variable totrev&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c44af30adbb9da617695cd55cac1bbb205a23a948d9e6619555ce2cbff437a63.png" src="../_images/c44af30adbb9da617695cd55cac1bbb205a23a948d9e6619555ce2cbff437a63.png" />
</div>
</div>
</section>
<section id="graficas-a-partir-de-groupby">
<h4>Gráficas a partir de <code class="docutils literal notranslate"><span class="pre">groupby</span></code><a class="headerlink" href="#graficas-a-partir-de-groupby" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span><span class="o">=</span><span class="n">df_con_etiquetas</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;area&#39;</span><span class="p">,</span><span class="s1">&#39;Nivel&#39;</span><span class="p">])[[</span><span class="s1">&#39;totmou&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">df4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/40f46e87a36ae85f13b09ae1a161e3e3dbf71dcca5e8cc2bc7415fd75c9a7c7f.png" src="../_images/40f46e87a36ae85f13b09ae1a161e3e3dbf71dcca5e8cc2bc7415fd75c9a7c7f.png" />
</div>
</div>
</section>
<section id="graficas-de-pandas">
<h4>Gráficas de <code class="docutils literal notranslate"><span class="pre">pandas</span></code><a class="headerlink" href="#graficas-de-pandas" title="Link to this heading">#</a></h4>
<p>El modulo<code class="docutils literal notranslate"><span class="pre">.plot()</span></code> genera por defecto una gráfica de línea, existen varios gráficos para los <code class="docutils literal notranslate"><span class="pre">DataFrameGroup</span></code></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- &#39;line&#39; : Gráfica de línea
- &#39;bar&#39; :  Diagrama de barras vertical
- &#39;barh&#39; : Diagrama de barras horizontal
- &#39;hist&#39; : histograma
- &#39;box&#39; : boxplot
- &#39;kde&#39; : Kernel de densidad
- &#39;area&#39; : Gráfica de área
- &#39;pie&#39; : Diagrama de torta
- &#39;scatter&#39; : Diagrama de dispersión
- &#39;hexbin&#39; : Diagrama de hexágonos
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Customer_ID&#39;, &#39;totmou&#39;, &#39;totrev&#39;, &#39;creditcd_x&#39;, &#39;eqpdays&#39;,
       &#39;custcare_Mean&#39;, &#39;new_cell&#39;, &#39;area&#39;, &#39;creditcd_y&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="p">[</span><span class="s2">&quot;creditcd_x&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;pie&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d1a6e24d04f2629b7e64990634a3b3976394193373bf84d2f9286b2801c3af65.png" src="../_images/d1a6e24d04f2629b7e64990634a3b3976394193373bf84d2f9286b2801c3af65.png" />
</div>
</div>
<p>Revisando la relación entre las dos variables <code class="docutils literal notranslate"><span class="pre">totrev</span></code> y <code class="docutils literal notranslate"><span class="pre">totmou</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;totrev&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;totmou&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;totrev&#39;, ylabel=&#39;totmou&#39;&gt;
</pre></div>
</div>
<img alt="../_images/14c7e5a02f7b693b9eb691a18355adb0d81925ca174683e434c0ca6b151a21bd.png" src="../_images/14c7e5a02f7b693b9eb691a18355adb0d81925ca174683e434c0ca6b151a21bd.png" />
</div>
</div>
</section>
</section>
<section id="seaborn">
<h3><code class="docutils literal notranslate"><span class="pre">Seaborn</span></code><a class="headerlink" href="#seaborn" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!pip install seaborn</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">df3</span><span class="p">[</span><span class="s2">&quot;totrev&quot;</span><span class="p">],</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot de variable totrev&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/22ecf2e19031221bcdb11f139ee7febed7ca0c9e7bc2b2e2b8e123bec606671f.png" src="../_images/22ecf2e19031221bcdb11f139ee7febed7ca0c9e7bc2b2e2b8e123bec606671f.png" />
</div>
</div>
</section>
<section id="graficas-de-parcela">
<h3>Gráficas de parcela<a class="headerlink" href="#graficas-de-parcela" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_ID</th>
      <th>totmou</th>
      <th>totrev</th>
      <th>creditcd_x</th>
      <th>eqpdays</th>
      <th>custcare_Mean</th>
      <th>new_cell</th>
      <th>area</th>
      <th>creditcd_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1082423</td>
      <td>7269.0</td>
      <td>906.58</td>
      <td>Y</td>
      <td>371</td>
      <td>14.333333</td>
      <td>U</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1069232</td>
      <td>13552.0</td>
      <td>1172.25</td>
      <td>N</td>
      <td>83</td>
      <td>3.666667</td>
      <td>U</td>
      <td>ATLANTIC SOUTH</td>
      <td>N</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1031705</td>
      <td>4152.0</td>
      <td>577.39</td>
      <td>Y</td>
      <td>675</td>
      <td>3.000000</td>
      <td>U</td>
      <td>NEW YORK CITY</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1089806</td>
      <td>1863.0</td>
      <td>294.26</td>
      <td>Y</td>
      <td>218</td>
      <td>11.000000</td>
      <td>U</td>
      <td>CHICAGO</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1076695</td>
      <td>4155.0</td>
      <td>433.16</td>
      <td>N</td>
      <td>222</td>
      <td>0.000000</td>
      <td>U</td>
      <td>NORTH FLORIDA</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9992</th>
      <td>1027614</td>
      <td>2570.0</td>
      <td>484.31</td>
      <td>Y</td>
      <td>611</td>
      <td>0.666667</td>
      <td>U</td>
      <td>CHICAGO</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9993</th>
      <td>1098422</td>
      <td>2105.0</td>
      <td>583.36</td>
      <td>Y</td>
      <td>1243</td>
      <td>0.000000</td>
      <td>U</td>
      <td>SOUTHWEST</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9994</th>
      <td>1096497</td>
      <td>3690.0</td>
      <td>294.29</td>
      <td>Y</td>
      <td>212</td>
      <td>0.666667</td>
      <td>Y</td>
      <td>NEW ENGLAND</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>1087248</td>
      <td>3333.0</td>
      <td>233.08</td>
      <td>Y</td>
      <td>290</td>
      <td>0.000000</td>
      <td>U</td>
      <td>CALIFORNIA NORTH</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>1099003</td>
      <td>5025.0</td>
      <td>1436.49</td>
      <td>Y</td>
      <td>1029</td>
      <td>0.333333</td>
      <td>U</td>
      <td>LOS ANGELES</td>
      <td>Y</td>
    </tr>
  </tbody>
</table>
<p>9997 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">116</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df3</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;creditcd_x&#39;</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;totrev&#39;</span><span class="p">,</span><span class="s1">&#39;totmou&#39;</span><span class="p">,</span><span class="s1">&#39;eqpdays&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Parcelas&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 11600x400 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/2b2700ab0b068c1c2f2b29f58f64c98e6c223bb1d435a5288a8f5afc6fd66f5a.png" src="../_images/2b2700ab0b068c1c2f2b29f58f64c98e6c223bb1d435a5288a8f5afc6fd66f5a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Nivel&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;totmou&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df_con_etiquetas</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot múltiple para Nivel de ingresos totales y </span><span class="se">\n</span><span class="s1"> total de minutos gastados&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fdd422505060a60dff95f5684d129e7b47fe5558d1d4fcac763cf73eface66b7.png" src="../_images/fdd422505060a60dff95f5684d129e7b47fe5558d1d4fcac763cf73eface66b7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;totmou&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Nivel&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">,</span>    <span class="n">data</span><span class="o">=</span><span class="n">df_con_etiquetas</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;totmou&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Nivel&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;violin&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_con_etiquetas</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x12004551c50&gt;
</pre></div>
</div>
<img alt="../_images/7b960aec068e6599d182843b4bd50008a042d216623744b33498d005dbd463b8.png" src="../_images/7b960aec068e6599d182843b4bd50008a042d216623744b33498d005dbd463b8.png" />
<img alt="../_images/ab86129aa5e3e1f3b5b9beac5f13e4dbcd45939335783904561140ea41110879.png" src="../_images/ab86129aa5e3e1f3b5b9beac5f13e4dbcd45939335783904561140ea41110879.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;totmou&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Nivel&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;creditcd_x&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;point&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df_con_etiquetas</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Nivel&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df_con_etiquetas</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;creditcd_x&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/83c24d8530ea9cf9e0b3a24e6078e9fc1ffc11daab49400d24bdab212f80984f.png" src="../_images/83c24d8530ea9cf9e0b3a24e6078e9fc1ffc11daab49400d24bdab212f80984f.png" />
<img alt="../_images/b9aacb58f4db574fe280aca479697e3b7ef981a1da41c3f7d5c50fabdb024403.png" src="../_images/b9aacb58f4db574fe280aca479697e3b7ef981a1da41c3f7d5c50fabdb024403.png" />
</div>
</div>
</section>
<section id="ejercicio-5">
<h3>Ejercicio 5<a class="headerlink" href="#ejercicio-5" title="Link to this heading">#</a></h3>
<p>Realice un  boxplot para la variable totmou segmentado por las variable  credict_x y Nivel_totrev</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># realice el ejercicio en este espacio</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="resumen">
<h2>Resumen<a class="headerlink" href="#resumen" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Leer datos desde archivos.</p></li>
<li><p>Agregar y manipular datos .</p></li>
<li><p>Analizar estadísticas de resumen y reunir información.</p></li>
<li><p>Usar matplotlib para crear gráficos para hacer análisis visual, además de otras librerías.</p></li>
</ol>
<p>Para más información</p>
<blockquote>
<div><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/index.html">https://pandas.pydata.org/pandas-docs/stable/getting_started/index.html</a></p>
</div></blockquote>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Cuadernos"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Intro%20a%20Python%20y%20Pandas.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introducción a Python y Pandas</p>
      </div>
    </a>
    <a class="right-next"
       href="Graficos.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Trabajemos en algunos gráficos</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion">Introducción</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#que-se-quiere-identificar">¿Qué se quiere identificar?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#insumos-para-tratar-este-problema">Insumos para tratar este problema</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#objetivos">Objetivos</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#importacion-de-paquetes">Importación de paquetes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion-a-pandas">Introducción a pandas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-informacion-en-pandas">Carga de información en <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manejo-de-datos-duplicados">Manejo de datos duplicados</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manejo-de-datos-perdidos-o-esperados">Manejo de datos perdidos o esperados</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculo-de-estadisticas-resumen">Cálculo de estadísticas resumen</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agregar-informacion-de-multiples-tablas">Agregar información de múltiples tablas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-1">Ejercicio 1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cruce-de-informacion">Cruce de información</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uniones-joins">Uniones (Joins)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-2">Ejercicio 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agrupacion-por-area-geografica">Agrupación por área geográfica</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-3">Ejercicio 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#etiquetando-valores-de-total-de-ingresos-en-categorias">Etiquetando valores de total de ingresos en categorías</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#existe-relacion-alguna-entre-el-total-de-minutos-usados-con-la-compania-y-el-ingreso-total-de-los-clientes">¿Existe relación alguna entre el total de minutos usados con la compañía y el ingreso total de los clientes?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-4">Ejercicio 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-total-de-llamadas-y-total-de-ingresos">Visualización de total de llamadas y total de ingresos</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#histograma">Histograma</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">Boxplot</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-a-partir-de-groupby">Gráficas a partir de <code class="docutils literal notranslate"><span class="pre">groupby</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-de-pandas">Gráficas de <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seaborn"><code class="docutils literal notranslate"><span class="pre">Seaborn</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-de-parcela">Gráficas de parcela</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejercicio-5">Ejercicio 5</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen">Resumen</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Isaac Zainea
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>